
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>stacker package &#8212; StACKER Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css?v=7f9a90b1" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=528dc5d9"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'stacker';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/esakkas24/stacker" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/esakkas24/stacker" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/stackerlogo.png" class="logo__image only-light" alt="StACKER Documentation - Home"/>
    <img src="_static/stacker_logo_dark.png" class="logo__image only-dark pst-js-only" alt="StACKER Documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/esakkas24/stacker" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="_autosummary/stacker.html">stacker</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.block_printing.html">stacker.block_printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.bottaro_routine.html">stacker.bottaro_routine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.combine_frames.html">stacker.combine_frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.compare_routine.html">stacker.compare_routine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.convert_to_python_command.html">stacker.convert_to_python_command</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.enable_printing.html">stacker.enable_printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.filter_traj_routine.html">stacker.filter_traj_routine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.res_distance_routine.html">stacker.res_distance_routine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.run_python_command.html">stacker.run_python_command</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.stack_events_routine.html">stacker.stack_events_routine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.system_routine.html">stacker.system_routine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.AtomEmpty.html">stacker.AtomEmpty</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.FrameEmpty.html">stacker.FrameEmpty</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.InvalidRoutine.html">stacker.InvalidRoutine</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.ResEmpty.html">stacker.ResEmpty</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/stacker.file_manipulation.html">file_manipulation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.file_manipulation.file_convert.html">stacker.file_manipulation.file_convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.file_manipulation.filter_traj.html">stacker.file_manipulation.filter_traj</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.file_manipulation.filter_traj_to_pdb.html">stacker.file_manipulation.filter_traj_to_pdb</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.file_manipulation.SmartIndexingAction.html">SmartIndexingAction</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/stacker.kmeans.html">kmeans</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.kmeans.create_kmeans_input.html">stacker.kmeans.create_kmeans_input</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.kmeans.plot_cluster_trj_data.html">stacker.kmeans.plot_cluster_trj_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.kmeans.plot_pca.html">stacker.kmeans.plot_pca</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.kmeans.plot_silhouette.html">stacker.kmeans.plot_silhouette</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.kmeans.read_and_preprocess_data.html">stacker.kmeans.read_and_preprocess_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.kmeans.run_kmeans.html">stacker.kmeans.run_kmeans</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.html">pairwise_distance</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.calculate_residue_distance.html">stacker.pairwise_distance.calculate_residue_distance</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.get_frame_average.html">stacker.pairwise_distance.get_frame_average</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.get_residue_distance_for_frame.html">stacker.pairwise_distance.get_residue_distance_for_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.get_residue_distance_for_trajectory.html">stacker.pairwise_distance.get_residue_distance_for_trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.get_top_stacking.html">stacker.pairwise_distance.get_top_stacking</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.increment_residue.html">stacker.pairwise_distance.increment_residue</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.system_stacking_fingerprints.html">stacker.pairwise_distance.system_stacking_fingerprints</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.MultiFrameTraj.html">stacker.pairwise_distance.MultiFrameTraj</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/stacker.residue_movement.html">residue_movement</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.residue_movement.calc_center_3pts.html">stacker.residue_movement.calc_center_3pts</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.residue_movement.calculate_bottaro_values_for_frame.html">stacker.residue_movement.calculate_bottaro_values_for_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.residue_movement.collect_atom_locations_by_frame.html">stacker.residue_movement.collect_atom_locations_by_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.residue_movement.correct_theta_sign.html">stacker.residue_movement.correct_theta_sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.residue_movement.create_base_from_coords_list.html">stacker.residue_movement.create_base_from_coords_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.residue_movement.write_bottaro_to_csv.html">stacker.residue_movement.write_bottaro_to_csv</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.residue_movement.Base.html">Base</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/stacker.vector.html">vector</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.vector.Vector.html">Vector</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="_autosummary/stacker.visualization.html">visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.visualization.create_axis_labels.html">stacker.visualization.create_axis_labels</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.visualization.create_parent_directories.html">stacker.visualization.create_parent_directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.visualization.display_arrays_as_video.html">stacker.visualization.display_arrays_as_video</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.visualization.set_polar_grid.html">stacker.visualization.set_polar_grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.visualization.visualize_two_residue_movement_heatmap.html">stacker.visualization.visualize_two_residue_movement_heatmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.visualization.visualize_two_residue_movement_scatterplot.html">stacker.visualization.visualize_two_residue_movement_scatterplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="_autosummary/stacker.visualization.NoResidues.html">stacker.visualization.NoResidues</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="_autosummary/stacker.file_manipulation.html">file_manipulation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.file_manipulation.file_convert.html">stacker.file_manipulation.file_convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.file_manipulation.filter_traj.html">stacker.file_manipulation.filter_traj</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.file_manipulation.filter_traj_to_pdb.html">stacker.file_manipulation.filter_traj_to_pdb</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.file_manipulation.SmartIndexingAction.html">SmartIndexingAction</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="_autosummary/stacker.kmeans.html">kmeans</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.kmeans.create_kmeans_input.html">stacker.kmeans.create_kmeans_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.kmeans.plot_cluster_trj_data.html">stacker.kmeans.plot_cluster_trj_data</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.kmeans.plot_pca.html">stacker.kmeans.plot_pca</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.kmeans.plot_silhouette.html">stacker.kmeans.plot_silhouette</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.kmeans.read_and_preprocess_data.html">stacker.kmeans.read_and_preprocess_data</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.kmeans.run_kmeans.html">stacker.kmeans.run_kmeans</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.html">pairwise_distance</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.calculate_residue_distance.html">stacker.pairwise_distance.calculate_residue_distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.get_frame_average.html">stacker.pairwise_distance.get_frame_average</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.get_residue_distance_for_frame.html">stacker.pairwise_distance.get_residue_distance_for_frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.get_residue_distance_for_trajectory.html">stacker.pairwise_distance.get_residue_distance_for_trajectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.get_top_stacking.html">stacker.pairwise_distance.get_top_stacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.increment_residue.html">stacker.pairwise_distance.increment_residue</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.system_stacking_fingerprints.html">stacker.pairwise_distance.system_stacking_fingerprints</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.pairwise_distance.MultiFrameTraj.html">stacker.pairwise_distance.MultiFrameTraj</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="_autosummary/stacker.residue_movement.html">residue_movement</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.residue_movement.calc_center_3pts.html">stacker.residue_movement.calc_center_3pts</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.residue_movement.calculate_bottaro_values_for_frame.html">stacker.residue_movement.calculate_bottaro_values_for_frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.residue_movement.collect_atom_locations_by_frame.html">stacker.residue_movement.collect_atom_locations_by_frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.residue_movement.correct_theta_sign.html">stacker.residue_movement.correct_theta_sign</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.residue_movement.create_base_from_coords_list.html">stacker.residue_movement.create_base_from_coords_list</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.residue_movement.write_bottaro_to_csv.html">stacker.residue_movement.write_bottaro_to_csv</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.residue_movement.Base.html">Base</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="_autosummary/stacker.vector.html">vector</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.vector.Vector.html">Vector</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="_autosummary/stacker.visualization.html">visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.visualization.create_axis_labels.html">stacker.visualization.create_axis_labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.visualization.create_parent_directories.html">stacker.visualization.create_parent_directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.visualization.display_arrays_as_video.html">stacker.visualization.display_arrays_as_video</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.visualization.set_polar_grid.html">stacker.visualization.set_polar_grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.visualization.visualize_two_residue_movement_heatmap.html">stacker.visualization.visualize_two_residue_movement_heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.visualization.visualize_two_residue_movement_scatterplot.html">stacker.visualization.visualize_two_residue_movement_scatterplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/stacker.visualization.NoResidues.html">stacker.visualization.NoResidues</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/esakkas24/stacker" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>stacker package</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.file_manipulation">stacker.file_manipulation module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction.parse_smart_index"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction.parse_smart_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction.__init__"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction._get_args"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction._get_args()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction._get_kwargs"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction._get_kwargs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction.format_usage"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction.format_usage()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.filter_traj"><code class="docutils literal notranslate"><span class="pre">filter_traj()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.filter_traj_to_pdb"><code class="docutils literal notranslate"><span class="pre">filter_traj_to_pdb()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.file_convert"><code class="docutils literal notranslate"><span class="pre">file_convert()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.kmeans">stacker.kmeans module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.read_and_preprocess_data"><code class="docutils literal notranslate"><span class="pre">read_and_preprocess_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.create_kmeans_input"><code class="docutils literal notranslate"><span class="pre">create_kmeans_input()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.plot_pca"><code class="docutils literal notranslate"><span class="pre">plot_pca()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.run_kmeans"><code class="docutils literal notranslate"><span class="pre">run_kmeans()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.plot_silhouette"><code class="docutils literal notranslate"><span class="pre">plot_silhouette()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.plot_cluster_trj_data"><code class="docutils literal notranslate"><span class="pre">plot_cluster_trj_data()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.pairwise_distance">stacker.pairwise_distance module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj.__init__"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj.add_note"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj.args"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj.with_traceback"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.calculate_residue_distance"><code class="docutils literal notranslate"><span class="pre">calculate_residue_distance()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.get_residue_distance_for_frame"><code class="docutils literal notranslate"><span class="pre">get_residue_distance_for_frame()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.get_residue_distance_for_trajectory"><code class="docutils literal notranslate"><span class="pre">get_residue_distance_for_trajectory()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.system_stacking_fingerprints"><code class="docutils literal notranslate"><span class="pre">system_stacking_fingerprints()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.get_frame_average"><code class="docutils literal notranslate"><span class="pre">get_frame_average()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.get_top_stacking"><code class="docutils literal notranslate"><span class="pre">get_top_stacking()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.increment_residue"><code class="docutils literal notranslate"><span class="pre">increment_residue()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.residue_movement">stacker.residue_movement module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.collect_atom_locations_by_frame"><code class="docutils literal notranslate"><span class="pre">collect_atom_locations_by_frame()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.calc_center_3pts"><code class="docutils literal notranslate"><span class="pre">calc_center_3pts()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.Base"><code class="docutils literal notranslate"><span class="pre">Base</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.Base.__init__"><code class="docutils literal notranslate"><span class="pre">Base.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.create_base_from_coords_list"><code class="docutils literal notranslate"><span class="pre">create_base_from_coords_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.correct_theta_sign"><code class="docutils literal notranslate"><span class="pre">correct_theta_sign()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.calculate_bottaro_values_for_frame"><code class="docutils literal notranslate"><span class="pre">calculate_bottaro_values_for_frame()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.write_bottaro_to_csv"><code class="docutils literal notranslate"><span class="pre">write_bottaro_to_csv()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.vector">stacker.vector module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector"><code class="docutils literal notranslate"><span class="pre">Vector</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.__init__"><code class="docutils literal notranslate"><span class="pre">Vector.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.calculate_cross_product"><code class="docutils literal notranslate"><span class="pre">Vector.calculate_cross_product()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.magnitude"><code class="docutils literal notranslate"><span class="pre">Vector.magnitude()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.calculate_projection"><code class="docutils literal notranslate"><span class="pre">Vector.calculate_projection()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.scale"><code class="docutils literal notranslate"><span class="pre">Vector.scale()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.visualization">stacker.visualization module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues"><code class="docutils literal notranslate"><span class="pre">NoResidues</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues.__init__"><code class="docutils literal notranslate"><span class="pre">NoResidues.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues.add_note"><code class="docutils literal notranslate"><span class="pre">NoResidues.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues.args"><code class="docutils literal notranslate"><span class="pre">NoResidues.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues.with_traceback"><code class="docutils literal notranslate"><span class="pre">NoResidues.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.create_parent_directories"><code class="docutils literal notranslate"><span class="pre">create_parent_directories()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.create_axis_labels"><code class="docutils literal notranslate"><span class="pre">create_axis_labels()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.display_arrays_as_video"><code class="docutils literal notranslate"><span class="pre">display_arrays_as_video()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.set_polar_grid"><code class="docutils literal notranslate"><span class="pre">set_polar_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.visualize_two_residue_movement_scatterplot"><code class="docutils literal notranslate"><span class="pre">visualize_two_residue_movement_scatterplot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.visualize_two_residue_movement_heatmap"><code class="docutils literal notranslate"><span class="pre">visualize_two_residue_movement_heatmap()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine.__init__"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine.add_note"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine.args"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine.with_traceback"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty"><code class="docutils literal notranslate"><span class="pre">ResEmpty</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty.__init__"><code class="docutils literal notranslate"><span class="pre">ResEmpty.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty.add_note"><code class="docutils literal notranslate"><span class="pre">ResEmpty.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty.args"><code class="docutils literal notranslate"><span class="pre">ResEmpty.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty.with_traceback"><code class="docutils literal notranslate"><span class="pre">ResEmpty.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty"><code class="docutils literal notranslate"><span class="pre">AtomEmpty</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty.__init__"><code class="docutils literal notranslate"><span class="pre">AtomEmpty.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty.add_note"><code class="docutils literal notranslate"><span class="pre">AtomEmpty.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty.args"><code class="docutils literal notranslate"><span class="pre">AtomEmpty.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty.with_traceback"><code class="docutils literal notranslate"><span class="pre">AtomEmpty.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty"><code class="docutils literal notranslate"><span class="pre">FrameEmpty</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty.__init__"><code class="docutils literal notranslate"><span class="pre">FrameEmpty.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty.add_note"><code class="docutils literal notranslate"><span class="pre">FrameEmpty.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty.args"><code class="docutils literal notranslate"><span class="pre">FrameEmpty.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty.with_traceback"><code class="docutils literal notranslate"><span class="pre">FrameEmpty.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.block_printing"><code class="docutils literal notranslate"><span class="pre">block_printing()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.enable_printing"><code class="docutils literal notranslate"><span class="pre">enable_printing()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.run_python_command"><code class="docutils literal notranslate"><span class="pre">run_python_command()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.convert_to_python_command"><code class="docutils literal notranslate"><span class="pre">convert_to_python_command()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.filter_traj_routine"><code class="docutils literal notranslate"><span class="pre">filter_traj_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.bottaro_routine"><code class="docutils literal notranslate"><span class="pre">bottaro_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.res_distance_routine"><code class="docutils literal notranslate"><span class="pre">res_distance_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.system_routine"><code class="docutils literal notranslate"><span class="pre">system_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.combine_frames"><code class="docutils literal notranslate"><span class="pre">combine_frames()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.stack_events_routine"><code class="docutils literal notranslate"><span class="pre">stack_events_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.compare_routine"><code class="docutils literal notranslate"><span class="pre">compare_routine()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="stacker-package">
<h1>stacker package<a class="headerlink" href="#stacker-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-stacker.file_manipulation">
<span id="stacker-file-manipulation-module"></span><h2>stacker.file_manipulation module<a class="headerlink" href="#module-stacker.file_manipulation" title="Link to this heading">#</a></h2>
<p>Filter Trajectory Files</p>
<p>This module contains functions for manipulating trajectory
files. This includes filtering a trajectory to desired atoms,
converting trajectory filetype, and outputting Python trajectories
to other filetypes (eg. prmtop, mdcrd, pdb)</p>
<dl class="py class">
<dt class="sig sig-object py" id="stacker.file_manipulation.SmartIndexingAction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SmartIndexingAction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option_strings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metavar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deprecated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/file_manipulation.html#SmartIndexingAction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.file_manipulation.SmartIndexingAction" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></p>
<p>Custom argparse action to handle smart indexing of frame numbers.</p>
<p>Parses a comma-separated list of frame numbers with optional ranges (e.g., ‘1-20, 34, 25, 50-100’)
and generates a list of individual frame numbers. Modifies the namespace by setting the attribute specified by the ‘dest’ parameter to the
list of individual frame numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>parser: argparse.ArgumentParser</strong></dt><dd><p>The argparse parser object.</p>
</dd>
<dt><strong>namespace: argparse.Namespace</strong></dt><dd><p>The argparse namespace.</p>
</dd>
<dt><strong>values: str</strong></dt><dd><p>The input string containing frame numbers and ranges.</p>
</dd>
<dt><strong>option_string: str, default=None</strong></dt><dd><p>The option string.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>dest</strong><span class="classifier">str</span></dt><dd><p>The attribute name in the namespace where the parsed list will be stored.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>__call__(parser, namespace, values, option_string=None)</strong></p></td>
<td><p>Parses the provided string of values into a sorted list of integers and sets it as an attribute in the namespace.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-fl&quot;</span><span class="p">,</span> <span class="s2">&quot;--frame_list&quot;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;FRAME_LIST&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Smart-indexed list of 1-indexed Frame Numbers within trajectory to analyze&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">SmartIndexingAction</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">([</span><span class="s2">&quot;-fl&quot;</span><span class="p">,</span> <span class="s2">&quot;1-20,34,25,50-100&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">frame_list</span><span class="p">)</span>
<span class="go">[1, 2, ..., 20, 34, 25, 50, 51, ..., 100]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stacker.file_manipulation.SmartIndexingAction.parse_smart_index">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse_smart_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/file_manipulation.html#SmartIndexingAction.parse_smart_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.file_manipulation.SmartIndexingAction.parse_smart_index" title="Link to this definition">#</a></dt>
<dd><p>Checks that an inputted variable is a list that can be smart indexed
and indexes it if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>value</strong><span class="classifier">str or set</span></dt><dd><p>The input string containing ranges (e.g., “1-5,10,15-20”)
or a set of integers.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>set</dt><dd><p>A set of integers parsed from the input.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If the input is not a string or set.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">SmartIndexingAction</span><span class="o">.</span><span class="n">parse_smart_index</span><span class="p">(</span><span class="s1">&#39;1-5,8,12-17&#39;</span><span class="p">)</span>
<span class="go">{1, 2, 3, 4, 5, 8, 12, 13, 14, 15, 16, 17}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.file_manipulation.SmartIndexingAction.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option_strings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metavar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deprecated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.file_manipulation.SmartIndexingAction.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.file_manipulation.SmartIndexingAction._get_args">
<span class="sig-name descname"><span class="pre">_get_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stacker.file_manipulation.SmartIndexingAction._get_args" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.file_manipulation.SmartIndexingAction._get_kwargs">
<span class="sig-name descname"><span class="pre">_get_kwargs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stacker.file_manipulation.SmartIndexingAction._get_kwargs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.file_manipulation.SmartIndexingAction.format_usage">
<span class="sig-name descname"><span class="pre">format_usage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stacker.file_manipulation.SmartIndexingAction.format_usage" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.file_manipulation.filter_traj">
<span class="sig-name descname"><span class="pre">filter_traj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residues_desired</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomnames_desired</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/file_manipulation.html#filter_traj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.file_manipulation.filter_traj" title="Link to this definition">#</a></dt>
<dd><p>Filters an input trajectory to only the specified atoms and residues</p>
<p>Filteres an input trajectory that contains all of the atoms in a topology to only
the desired atoms at the desired residues (eg. the atoms necessary to find the 
center of geometry of a residue). If residues_desired or atomnames_desired are
empty, all residues or atoms are included respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trajectory_filename</strong><span class="classifier">str</span></dt><dd><p>filepath of the trajectory</p>
</dd>
<dt><strong>topology_filename</strong><span class="classifier">str</span></dt><dd><p>filepath of the topology of the molecule</p>
</dd>
<dt><strong>residues_desired</strong><span class="classifier">set or str</span></dt><dd><p>1-indexed residue numbers of residues to keep in the trajectory.
Accepts smart-indexed str representing a list of residues (e.g ‘1-5,6,39-48’)
If Empty, include all residues.</p>
</dd>
<dt><strong>atomnames_desired</strong><span class="classifier">set</span></dt><dd><p>atomnames to keep in the trajectory. If Empty, include all atoms.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filtered_trajectory</strong><span class="classifier">mdtraj.Trajectory</span></dt><dd><p>a trajectory object representing the filtered structure across all frames</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#stacker.file_manipulation.filter_traj_to_pdb" title="stacker.file_manipulation.filter_traj_to_pdb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj_to_pdb</span></code></a></dt><dd><p>Filters an input trajectory to only the specified  atoms and residues and outputs to pdb</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">mdtraj.Trajectory</span></code></dt><dd><p>The Trajectory object in mdtraj package</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Inputed trajectory should have 1-indexed Residue Indices, 
Outputed trajectory object will be 0-indexed.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="s1">&#39;stacker/testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">residues_desired</span> <span class="o">=</span> <span class="p">{</span><span class="mi">426</span><span class="p">,</span><span class="mi">427</span><span class="p">},</span> 
<span class="gp">... </span>                            <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="go">WARNING: Residue Indices are expected to be 1-indexed</span>
<span class="go">Reading trajectory...</span>
<span class="go">Reading topology...</span>
<span class="go">Filtering trajectory...</span>
<span class="go">WARNING: Output filtered traj atom, residue, and chain indices are zero-indexed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="p">,</span> <span class="n">bonds</span> <span class="o">=</span> <span class="n">filtered_traj</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="go">serial name element  resSeq resName  chainID segmentID</span>
<span class="go">0   None   C6       C     425       G        0          </span>
<span class="go">1   None   C2       C     425       G        0          </span>
<span class="go">2   None   C4       C     425       G        0          </span>
<span class="go">3   None   C6       C     426       C        0          </span>
<span class="go">4   None   C4       C     426       C        0          </span>
<span class="go">5   None   C2       C     426       C        0       </span>
</pre></div>
</div>
<p>Residue Number support SmartIndexing</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;../testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="s1">&#39;../testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                             <span class="n">residues_desired</span> <span class="o">=</span> <span class="s1">&#39;1-16,25,50-57&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                             <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="go">WARNING: Residue Indices are expected to be 1-indexed</span>
<span class="go">Reading trajectory...</span>
<span class="go">Reading topology...</span>
<span class="go">Filtering trajectory...</span>
<span class="go">WARNING: Output filtered traj atom, residue, and chain indices are zero-indexed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span>
<span class="go">&lt;mdtraj.Trajectory with 10 frames, 75 atoms, 25 residues, without unitcells at 0x1156c3ed0&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.file_manipulation.filter_traj_to_pdb">
<span class="sig-name descname"><span class="pre">filter_traj_to_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_pdb_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residues_desired</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomnames_desired</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/file_manipulation.html#filter_traj_to_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.file_manipulation.filter_traj_to_pdb" title="Link to this definition">#</a></dt>
<dd><p>Filters an input trajectory to only the specified atoms and residues and outputs to pdb</p>
<p>Filteres an input trajectory that contains all of the atoms in a trajectory to only
the desired atoms at the desired residues (eg. the atoms necessary to find the 
center of geometry of a residue) and writes the output to a specified pdb file.
If residues_desired or atomnames_desired are empty, all residues or atoms are included respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trajectory_filename</strong><span class="classifier">str</span></dt><dd><p>path to file of the concatenated trajectory. Should be resampled to the
1 in 50 frames sampled trajectories for each replicate.</p>
</dd>
<dt><strong>topology_filename</strong><span class="classifier">str</span></dt><dd><p>path to file of the topology of the molecule</p>
</dd>
<dt><strong>output_pdb_filename</strong><span class="classifier">str</span></dt><dd><p>path to the output pdb file</p>
</dd>
<dt><strong>residues_desired</strong><span class="classifier">set or str</span></dt><dd><p>1-indexed residue numbers of residues to keep in the trajectory.
Accepts smart-indexed str representing a list of residues (e.g ‘1-5,6,39-48’)
If Empty, include all residues.</p>
</dd>
<dt><strong>atomnames_desired</strong><span class="classifier">set</span></dt><dd><p>atomnames to keep in the trajectory</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#stacker.file_manipulation.filter_traj" title="stacker.file_manipulation.filter_traj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj</span></code></a></dt><dd><p>Filters an input trajectory to only the specified atoms and residues</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Inputed trajectory should have 1-indexed Residue Indices, 
Outputed trajectory object will be 0-indexed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.file_manipulation.file_convert">
<span class="sig-name descname"><span class="pre">file_convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/file_manipulation.html#file_convert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.file_manipulation.file_convert" title="Link to this definition">#</a></dt>
<dd><p>Converts a trajectory input file to a new output type.</p>
<p>The output file type is determined by the <cite>output_file</cite> extension. Uses <cite>mdtraj.save()</cite> commands to convert 
trajectory files to various file types such as <cite>mdtraj.save_mdcrd()</cite>, <cite>mdtraj.save_pdb()</cite>, <cite>mdtraj.save_xyz()</cite>, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trajectory_filename</strong><span class="classifier">str</span></dt><dd><p>Path to the file of the concatenated trajectory (eg. .mdcrd file).</p>
</dd>
<dt><strong>topology_filename</strong><span class="classifier">str</span></dt><dd><p>Path to the file of the topology of the molecule (.prmtop file).</p>
</dd>
<dt><strong>output_file</strong><span class="classifier">str</span></dt><dd><p>Output filename (include .mdcrd, .pdb, etc.).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">mdtraj.load</span></code></dt><dd><p>Load trajectory files</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">mdtraj.save</span></code></dt><dd><p>Save md.Trajectory to file</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">mdtraj.load_xyz</span></code></dt><dd><p>Load a .xyz trajectory file</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Output filetype determined from file extension of <cite>output_file</cite> parameter.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mdtraj</span> <span class="k">as</span> <span class="nn">md</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">file_convert</span><span class="p">(</span><span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                <span class="s1">&#39;stacker/testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                <span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.xyz&#39;</span><span class="p">)</span>
<span class="go">WARNING: Output file atom, residue, and chain indices are zero-indexed</span>
<span class="go">Trajectory written to: stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md</span><span class="o">.</span><span class="n">load_xyz</span><span class="p">(</span><span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.xyz&#39;</span><span class="p">,</span> 
<span class="gp">... </span>            <span class="n">top</span><span class="o">=</span><span class="s1">&#39;stacker/testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">)</span>
<span class="go">&lt;mdtraj.Trajectory with 10 frames, 12089 atoms, 494 residues, without unitcells at 0x10bb75cd0&gt;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-stacker.kmeans">
<span id="stacker-kmeans-module"></span><h2>stacker.kmeans module<a class="headerlink" href="#module-stacker.kmeans" title="Link to this heading">#</a></h2>
<p>Runs K Means Clustering and Principal Component Analysis</p>
<p>This module contains functions to run K Means Clustering on SSF
results and visualize the clusters with barplots, silhouette analysis,
and PCA scatterplots.</p>
<dl class="py function">
<dt class="sig sig-object py" id="stacker.kmeans.read_and_preprocess_data">
<span class="sig-name descname"><span class="pre">read_and_preprocess_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">(name1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/kmeans.html#read_and_preprocess_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.kmeans.read_and_preprocess_data" title="Link to this definition">#</a></dt>
<dd><p>Reads and preprocesses SSF data for K Means analysis per dataset.</p>
<p>Reads SSF data from txt files for each dataset, decompresses the data, 
and attaches each Trajectory to its frame-wise SSF results. The values
are flattened SSF lists, so rather than a 3200 frames x 127 res x 127 res, 
it’s a 3200 frames x 16129 res-res pairs. For example, a 2-residue, 2-frame
SSF of</p>
<blockquote>
<div><p>[ [[1, 2],
[3, 4]],</p>
<p>[[5, 6],
[7, 8]] ]</p>
</div></blockquote>
<p>is flattened to:</p>
<blockquote>
<div><p>[[1, 2, 3, 4],
[5, 6, 7, 8]]</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>name1, name2, …</strong><span class="classifier">list of str</span></dt><dd><p>List of dataset names to read and preprocess.</p>
</dd>
<dt><strong>data_path</strong><span class="classifier">str</span></dt><dd><p>path to the directory containing the SSF data
outputted from <cite>-s ssf -d output.txt</cite></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>data_arrays</strong><span class="classifier">dict</span></dt><dd><p>Dictionary where keys are dataset names and values are the processed data arrays.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#stacker.kmeans.create_kmeans_input" title="stacker.kmeans.create_kmeans_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_kmeans_input</span></code></a></dt><dd><p>Stacks SSF data into a single 2D Numpy array.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;5JUP_N2_tGGG_aCCU_+1GCU&#39;</span><span class="p">,</span> <span class="s1">&#39;5JUP_N2_tGGG_aCCU_+1CGU&#39;</span><span class="p">]</span>  <span class="c1"># 3200 frames, SSFs of 127 x 127 residues</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;/home66/esakkas/STACKER/DATA/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_arrays</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">read_and_preprocess_data</span><span class="p">(</span><span class="n">dataset_names</span><span class="p">,</span> <span class="n">data_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data_arrays</span><span class="p">[</span><span class="s1">&#39;dataset1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3200, 16129)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.kmeans.create_kmeans_input">
<span class="sig-name descname"><span class="pre">create_kmeans_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_arrays</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/kmeans.html#create_kmeans_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.kmeans.create_kmeans_input" title="Link to this definition">#</a></dt>
<dd><p>Blinds SSF Data (removes trajectory labels) for input to K Means</p>
<p>Stacks SSF data into a single 2D numpy array from all frames of 
all trajectories without labels for each frame. Used for input to
KMeans Clustering</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_arrays</strong><span class="classifier">dict</span></dt><dd><p>Output of read_and_preprocess_data(). Dictionary where keys are dataset 
names and values are the processed data arrays.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>blinded_data</strong><span class="classifier">np.typing.ArrayLike</span></dt><dd><p>A 2D numpy array containing all frames stacked together.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#stacker.kmeans.read_and_preprocess_data" title="stacker.kmeans.read_and_preprocess_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_and_preprocess_data</span></code></a></dt><dd><p>Reads and preprocesses data for each dataset</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_arrays</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;dataset1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3200</span><span class="p">,</span> <span class="mi">16129</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;dataset2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3200</span><span class="p">,</span> <span class="mi">16129</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kmeans_input</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">create_kmeans_input</span><span class="p">(</span><span class="n">data_arrays</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kmeans_input</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(6400, 16129)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.kmeans.plot_pca">
<span class="sig-name descname"><span class="pre">plot_pca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blinded_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coloring</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dataset'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/kmeans.html#plot_pca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.kmeans.plot_pca" title="Link to this definition">#</a></dt>
<dd><p>Creates PCA Plot to compare systems in 2D</p>
<p>Creates a PCA plot that can be colored by the KMeans clustering result
or by dataset. Compares SSFs similarly to K Means.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>blinded_data</strong><span class="classifier">np.typing.ArrayLike</span></dt><dd><p>A 2D numpy array containing all frames stacked together.
Output of create_kmeans_input()</p>
</dd>
<dt><strong>n_clusters</strong><span class="classifier">int, default = 0</span></dt><dd><p>The number of clusters to form.</p>
</dd>
<dt><strong>coloring</strong><span class="classifier">{‘dataset’, ‘kmeans’, ‘facet’}</span></dt><dd><p>Method to color the points on the scatterplot. Options:
- dataset:  Plot all points on the same scatterplot and color by dataset of origin.
- kmeans: Plot all points on the same scatterplot and color by KMeans Cluster with n_clusters
- facet: Same as dataset but plot each dataset on a different coordinate grid.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#stacker.kmeans.create_kmeans_input" title="stacker.kmeans.create_kmeans_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_kmeans_input</span></code></a></dt><dd><p>blinds SSF Data for input to K Means</p>
</dd>
<dt><a class="reference internal" href="#stacker.kmeans.read_and_preprocess_data" title="stacker.kmeans.read_and_preprocess_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_and_preprocess_data</span></code></a></dt><dd><p>reads and preprocesses SSF data for K Means analysis per dataset</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.decomposition.PCA</span></code></dt><dd><p>Runs PCA</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.kmeans.run_kmeans">
<span class="sig-name descname"><span class="pre">run_kmeans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blinded_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_CLUSTERS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/kmeans.html#run_kmeans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.kmeans.run_kmeans" title="Link to this definition">#</a></dt>
<dd><p>Performs KMeans clustering on blinded SSF data and saves the results.</p>
<p>This function applies the KMeans clustering algorithm to the provided
blinded SSF data, assigns each frame to a cluster, and counts the number of
frames in each cluster for each dataset. The results are printed and
saved to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>blinded_data</strong><span class="classifier">np.typing.ArrayLike</span></dt><dd><p>A 2D numpy array containing all frames stacked together.
Output of create_kmeans_input()</p>
</dd>
<dt><strong>N_CLUSTERS</strong><span class="classifier">int</span></dt><dd><p>The number of clusters to form</p>
</dd>
<dt><strong>max_iter</strong><span class="classifier">int, default=1000</span></dt><dd><p>Maximum number of iterations of the k-means algorithm for a single run.</p>
</dd>
<dt><strong>n_init</strong><span class="classifier">int, default=20</span></dt><dd><p>Number of times the k-means algorithm will be run with different centroid seeds.</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">int, default=1</span></dt><dd><p>Determines random number generation for centroid initialization.</p>
</dd>
<dt><strong>outdir</strong><span class="classifier">str, default=’’</span></dt><dd><p>Directory to save the clustering results.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#stacker.kmeans.create_kmeans_input" title="stacker.kmeans.create_kmeans_input"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_kmeans_input</span></code></a></dt><dd><p>blinds SSF Data for input to K Means</p>
</dd>
<dt><a class="reference internal" href="#stacker.kmeans.read_and_preprocess_data" title="stacker.kmeans.read_and_preprocess_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_and_preprocess_data</span></code></a></dt><dd><p>reads and preprocesses SSF data for K Means analysis per dataset</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_arrays</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;dataset1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3200</span><span class="p">,</span> <span class="mi">16129</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;dataset2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3200</span><span class="p">,</span> <span class="mi">16129</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blinded_data</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">create_kmeans_input</span><span class="p">(</span><span class="n">data_arrays</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">run_kmeans</span><span class="p">(</span><span class="n">blinded_data</span><span class="p">,</span> <span class="n">N_CLUSTERS</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Reading data: dataset1</span>
<span class="go">Reading data: dataset2</span>
<span class="go">(6400, 16129)</span>
<span class="go">{&#39;dataset1&#39;: array([800, 800, 800, 800]), &#39;dataset2&#39;: array([800, 800, 800, 800])}</span>
<span class="go">Dataset: dataset1</span>
<span class="go">    Cluster 1: 800 matrices</span>
<span class="go">    Cluster 2: 800 matrices</span>
<span class="go">    Cluster 3: 800 matrices</span>
<span class="go">    Cluster 4: 800 matrices</span>
<span class="go">Dataset: dataset2</span>
<span class="go">    Cluster 1: 800 matrices</span>
<span class="go">    Cluster 2: 800 matrices</span>
<span class="go">    Cluster 3: 800 matrices</span>
<span class="go">    Cluster 4: 800 matrices</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.kmeans.plot_silhouette">
<span class="sig-name descname"><span class="pre">plot_silhouette</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/kmeans.html#plot_silhouette"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.kmeans.plot_silhouette" title="Link to this definition">#</a></dt>
<dd><p>Creates Silhouette plots to determine the best number of clusters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_clusters</strong><span class="classifier">int, default = 0</span></dt><dd><p>The number of clusters to form.</p>
</dd>
<dt><strong>dataset</strong><span class="classifier">np.typing.ArrayLike</span></dt><dd><p>A 2D numpy array containing all frames stacked together.
Output of create_kmeans_input()</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.kmeans.plot_cluster_trj_data">
<span class="sig-name descname"><span class="pre">plot_cluster_trj_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cluster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seeded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/kmeans.html#plot_cluster_trj_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.kmeans.plot_cluster_trj_data" title="Link to this definition">#</a></dt>
<dd><p>Plots the output of run_kmeans() to a PNG file.</p>
<p>Creates a grouped bar plot of the number of frames from each trajectory in each cluster
following KMeans clustering. Writes the plot output to a PNG file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_file</strong><span class="classifier">str</span></dt><dd><p>Path to clustering results written by run_kmeans()</p>
</dd>
<dt><strong>n_cluster</strong><span class="classifier">int</span></dt><dd><p>The number of K Means Clusters, given to run_kmeans() as param.</p>
</dd>
<dt><strong>outfile</strong><span class="classifier">str</span></dt><dd><p>Filepath where the plot PNG file will be saved.</p>
</dd>
<dt><strong>seeded</strong><span class="classifier">bool, default=False</span></dt><dd><p>True if a random seed was assigned during clustering using kseed, False otherwise.
Used to label plot title, no other impact.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>This will read the clustering results from ‘clustering_results.txt’,
create a bar plot, and save it as ‘kmeans_plot.cluster_4.png’ in the 
specified output directory.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">plot_cluster_trj_data</span><span class="p">(</span><span class="s1">&#39;clustering_results.txt&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;/path/to/output/&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-stacker.pairwise_distance">
<span id="stacker-pairwise-distance-module"></span><h2>stacker.pairwise_distance module<a class="headerlink" href="#module-stacker.pairwise_distance" title="Link to this heading">#</a></h2>
<p>Create and Analyze System Stacking Fingerprints (SSFs)</p>
<p>This module contains the functions to create and analyze System
Stacking Fingerprints. It allows the user to generate pairwise
distance data across a trajectory and compare these matrices across
different trajectories.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="stacker.pairwise_distance.MultiFrameTraj">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MultiFrameTraj</span></span><a class="reference internal" href="_modules/stacker/pairwise_distance.html#MultiFrameTraj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.pairwise_distance.MultiFrameTraj" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>A multi-frame trajectory is passed to a one-frame function</p>
<p>Raised if a multi-frame trajectory is passed to a function that
only works on one trajectory (eg. calculate_residue_distance_vector())</p>
<dl class="py method">
<dt class="sig sig-object py" id="stacker.pairwise_distance.MultiFrameTraj.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.pairwise_distance.MultiFrameTraj.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.pairwise_distance.MultiFrameTraj.add_note">
<span class="sig-name descname"><span class="pre">add_note</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.pairwise_distance.MultiFrameTraj.add_note" title="Link to this definition">#</a></dt>
<dd><p>Exception.add_note(note) –
add a note to the exception</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stacker.pairwise_distance.MultiFrameTraj.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#stacker.pairwise_distance.MultiFrameTraj.args" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.pairwise_distance.MultiFrameTraj.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.pairwise_distance.MultiFrameTraj.with_traceback" title="Link to this definition">#</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.pairwise_distance.calculate_residue_distance">
<span class="sig-name descname"><span class="pre">calculate_residue_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res1_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res2_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res1_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res2_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/pairwise_distance.html#calculate_residue_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.pairwise_distance.calculate_residue_distance" title="Link to this definition">#</a></dt>
<dd><p>Calculates the vector between two residues with x, y, z units in Angstroms.</p>
<p>Calculates the distance between the center of two residues. The center is defined
by the average x, y, z position of three passed atoms for each residue (typically
every other carbon on the 6-carbon ring of the nucleotide base).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trajectory</strong><span class="classifier">md.Trajectory</span></dt><dd><p>Single frame trajectory.</p>
</dd>
<dt><strong>res1_num</strong><span class="classifier">int</span></dt><dd><p>1-indexed residue number of the first residue (PDB Column 5).</p>
</dd>
<dt><strong>res2_num</strong><span class="classifier">int</span></dt><dd><p>1-indexed residue number of the second residue (PDB Column 5).</p>
</dd>
<dt><strong>res1_atoms</strong><span class="classifier">tuple, default=(“C2”, “C4”, “C6”)</span></dt><dd><p>Atom names whose positions are averaged to find the center of residue 1.</p>
</dd>
<dt><strong>res2_atoms</strong><span class="classifier">tuple, default=(“C2”, “C4”, “C6”)</span></dt><dd><p>Atom names whose positions are averaged to find the center of residue 2.</p>
</dd>
<dt><strong>frame</strong><span class="classifier">int, default=1</span></dt><dd><p>1-indexed frame number of trajectory to calculate the distance.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>distance_res12</strong><span class="classifier">Vector</span></dt><dd><p>Vector from the center of geometry of residue 1 to residue 2.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.get_residue_distance_for_frame" title="stacker.pairwise_distance.get_residue_distance_for_frame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_residue_distance_for_frame</span></code></a></dt><dd><p>Calculates pairwise distances between all residues in a given frame.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                             <span class="s1">&#39;testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                             <span class="n">residues_desired</span> <span class="o">=</span> <span class="p">{</span><span class="mi">426</span><span class="p">,</span><span class="mi">427</span><span class="p">},</span> 
<span class="gp">... </span>                             <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="go">WARNING: Residue Indices are expected to be 1-indexed</span>
<span class="go">Reading trajectory...</span>
<span class="go">Reading topology...</span>
<span class="go">Filtering trajectory...</span>
<span class="go">WARNING: Output filtered traj atom, residue, and chain indices are zero-indexed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distance_vec</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">calculate_residue_distance</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">trajectory</span><span class="o">=</span><span class="n">filtered_traj</span><span class="p">,</span> 
<span class="gp">... </span>    <span class="n">res1_num</span><span class="o">=</span><span class="mi">426</span><span class="p">,</span> 
<span class="gp">... </span>    <span class="n">res2_num</span><span class="o">=</span><span class="mi">427</span><span class="p">,</span> 
<span class="gp">... </span>    <span class="n">res1_atoms</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span> <span class="s2">&quot;C4&quot;</span><span class="p">,</span> <span class="s2">&quot;C6&quot;</span><span class="p">),</span> 
<span class="gp">... </span>    <span class="n">res2_atoms</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;C2&quot;</span><span class="p">,</span> <span class="s2">&quot;C4&quot;</span><span class="p">,</span> <span class="s2">&quot;C6&quot;</span><span class="p">),</span> 
<span class="gp">... </span>    <span class="n">frame</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distance_vec</span><span class="o">.</span><span class="n">magnitude</span><span class="p">()</span>
<span class="go">7.5253396</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.pairwise_distance.get_residue_distance_for_frame">
<span class="sig-name descname"><span class="pre">get_residue_distance_for_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res1_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res2_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/pairwise_distance.html#get_residue_distance_for_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.pairwise_distance.get_residue_distance_for_frame" title="Link to this definition">#</a></dt>
<dd><p>Calculates System Stacking Fingerprint (SSF) between all residues in a given frame.</p>
<p>Calculates the distances between all pairs of residues in a given frame
of a trajectory. Outputs as a square matrix with all residues on each
side. This is the data behind a System Stacking Fingerprint (SSF)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trajectory</strong><span class="classifier">md.Trajectory</span></dt><dd><p>Trajectory to analyze (must have a topology).</p>
</dd>
<dt><strong>frame</strong><span class="classifier">int</span></dt><dd><p>1-indexed frame to analyze.</p>
</dd>
<dt><strong>res1_atoms</strong><span class="classifier">tuple, default=(“C2”, “C4”, “C6”)</span></dt><dd><p>Atom names whose positions are averaged to find the center of residue 1.</p>
</dd>
<dt><strong>res2_atoms</strong><span class="classifier">tuple, default=(“C2”, “C4”, “C6”)</span></dt><dd><p>Atom names whose positions are averaged to find the center of residue 2.</p>
</dd>
<dt><strong>write_output</strong><span class="classifier">bool, default=True</span></dt><dd><p>If True, displays a loading screen to standard output.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>pairwise_distances</strong><span class="classifier">np.typing.ArrayLike</span></dt><dd><p>Matrix where position (i, j) represents the distance from residue i to residue j.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.get_residue_distance_for_trajectory" title="stacker.pairwise_distance.get_residue_distance_for_trajectory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_residue_distance_for_trajectory</span></code></a></dt><dd><p>Calculates System Stacking Fingerprints (SSFs) for all residues across all frames of a trajectory</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj</span></code></dt><dd><p>Filters an input trajectory to only the specified atoms and residues</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">mdtraj.load</span></code></dt><dd><p>Load a trajectory+topology file</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="s1">&#39;stacker/testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">residues_desired</span> <span class="o">=</span> <span class="s1">&#39;2-5,13-16,23-31,46-51,65-76,88-104,122-141,164-175,184-198,288-289,401-415,420-430&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssf</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">get_residue_distance_for_frame</span><span class="p">(</span><span class="n">filtered_traj</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">write_output</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssf</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(127, 127)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.pairwise_distance.get_residue_distance_for_trajectory">
<span class="sig-name descname"><span class="pre">get_residue_distance_for_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res1_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res2_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/pairwise_distance.html#get_residue_distance_for_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.pairwise_distance.get_residue_distance_for_trajectory" title="Link to this definition">#</a></dt>
<dd><p>Calculates System Stacking Fingerprints (SSFs) for all residues across all frames of a trajectory.</p>
<p>Calculates the distances between all pairs of residues for all frames
of a trajectory. Outputs as a square matrix with all residues on each
side. This is the data behind a System Stacking Fingerprint (SSF)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trajectory</strong><span class="classifier">md.Trajectory</span></dt><dd><p>Trajectory to analyze (must have a topology).
Output of st.filter_traj() or mdtraj.load()</p>
</dd>
<dt><strong>frames</strong><span class="classifier">array_like or str</span></dt><dd><p>list of frame indices to analyze (1-indexed).
Accepts smart-indexed str representing a list of frames (e.g ‘1-5,6,39-48’)</p>
</dd>
<dt><strong>res1_atoms</strong><span class="classifier">tuple, default=(“C2”, “C4”, “C6”)</span></dt><dd><p>Atom names whose positions are averaged to find the center of residue 1.</p>
</dd>
<dt><strong>res2_atoms</strong><span class="classifier">tuple, default=(“C2”, “C4”, “C6”)</span></dt><dd><p>Atom names whose positions are averaged to find the center of residue 2.</p>
</dd>
<dt><strong>threads</strong><span class="classifier">int, default=1</span></dt><dd><p>Number of threads to use for parallel processing.</p>
</dd>
<dt><strong>write_output</strong><span class="classifier">bool, default=True</span></dt><dd><p>If True, displays a loading screen to standard output. Do not use if
threads &gt; 1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ssf_per_frame</strong><span class="classifier">array_like</span></dt><dd><p>List where <cite>pairwise_distances[f]</cite> is the output of
<cite>get_residue_distance_for_frame(trajectory, f, res1_atoms, res2_atoms)</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.system_stacking_fingerprints" title="stacker.pairwise_distance.system_stacking_fingerprints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">system_stacking_fingerprints</span></code></a></dt><dd><p>Alias for this function</p>
</dd>
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.get_residue_distance_for_frame" title="stacker.pairwise_distance.get_residue_distance_for_frame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_residue_distance_for_frame</span></code></a></dt><dd><p>Calculates System Stacking Fingerprint (SSF) between all residues in a given frame.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj</span></code></dt><dd><p>Filters an input trajectory to only the specified atoms and residues</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">mdtraj.load</span></code></dt><dd><p>Load a trajectory+topology file</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="s1">&#39;stacker/testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">residues_desired</span> <span class="o">=</span> <span class="s1">&#39;2-5,13-16,23-31,46-51,65-76,88-104,122-141,164-175,184-198,288-289,401-415,420-430&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssfs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">get_residue_distance_for_trajectory</span><span class="p">(</span><span class="n">filtered_traj</span><span class="p">,</span> <span class="n">frames</span> <span class="o">=</span> <span class="s1">&#39;1-3&#39;</span><span class="p">,</span> <span class="n">write_output</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssfs</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 127, 127)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.pairwise_distance.system_stacking_fingerprints">
<span class="sig-name descname"><span class="pre">system_stacking_fingerprints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res1_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res2_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/pairwise_distance.html#system_stacking_fingerprints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.pairwise_distance.system_stacking_fingerprints" title="Link to this definition">#</a></dt>
<dd><p>Alias for <cite>get_residue_distance_for_trajectory()</cite>.</p>
<p>Calculates System Stacking Fingerprints (SSFs) for all residues across all frames of a trajectory.</p>
<p>Calculates the distances between all pairs of residues for all frames
of a trajectory. Outputs as a square matrix with all residues on each
side. This is the data behind a System Stacking Fingerprint (SSF)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trajectory</strong><span class="classifier">md.Trajectory</span></dt><dd><p>Trajectory to analyze (must have a topology).
Output of st.filter_traj() or mdtraj.load()</p>
</dd>
<dt><strong>frames</strong><span class="classifier">array_like or str</span></dt><dd><p>list of frame indices to analyze (1-indexed).
Accepts smart-indexed str representing a list of frames (e.g ‘1-5,6,39-48’)</p>
</dd>
<dt><strong>res1_atoms</strong><span class="classifier">tuple, default=(“C2”, “C4”, “C6”)</span></dt><dd><p>Atom names whose positions are averaged to find the center of residue 1.</p>
</dd>
<dt><strong>res2_atoms</strong><span class="classifier">tuple, default=(“C2”, “C4”, “C6”)</span></dt><dd><p>Atom names whose positions are averaged to find the center of residue 2.</p>
</dd>
<dt><strong>threads</strong><span class="classifier">int, default=1</span></dt><dd><p>Number of threads to use for parallel processing.</p>
</dd>
<dt><strong>write_output</strong><span class="classifier">bool, default=True</span></dt><dd><p>If True, displays a loading screen to standard output. Do not use if
threads &gt; 1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ssf_per_frame</strong><span class="classifier">array_like</span></dt><dd><p>List where <cite>pairwise_distances[f]</cite> is the output of
<cite>get_residue_distance_for_frame(trajectory, f, res1_atoms, res2_atoms)</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.system_stacking_fingerprints" title="stacker.pairwise_distance.system_stacking_fingerprints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">system_stacking_fingerprints</span></code></a></dt><dd><p>Alias for this function</p>
</dd>
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.get_residue_distance_for_frame" title="stacker.pairwise_distance.get_residue_distance_for_frame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_residue_distance_for_frame</span></code></a></dt><dd><p>Calculates System Stacking Fingerprint (SSF) between all residues in a given frame.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj</span></code></dt><dd><p>Filters an input trajectory to only the specified atoms and residues</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">mdtraj.load</span></code></dt><dd><p>Load a trajectory+topology file</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="s1">&#39;stacker/testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">residues_desired</span> <span class="o">=</span> <span class="s1">&#39;2-5,13-16,23-31,46-51,65-76,88-104,122-141,164-175,184-198,288-289,401-415,420-430&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssfs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">get_residue_distance_for_trajectory</span><span class="p">(</span><span class="n">filtered_traj</span><span class="p">,</span> <span class="n">frames</span> <span class="o">=</span> <span class="s1">&#39;1-3&#39;</span><span class="p">,</span> <span class="n">write_output</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssfs</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 127, 127)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.pairwise_distance.get_frame_average">
<span class="sig-name descname"><span class="pre">get_frame_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/pairwise_distance.html#get_frame_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.pairwise_distance.get_frame_average" title="Link to this definition">#</a></dt>
<dd><p>Calculates an average System Stacking Fingerprint (SSF) across multiple SSFs</p>
<p>Used to calculate an average SSF across multiple frames of a trajectory. Can
average the result of <cite>get_residue_distance_for_trajectory</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frames</strong><span class="classifier">numpy.typing.ArrayLike</span></dt><dd><p>List or array of 2D NumPy arrays representing a pairwise distance matrix
of an MD structure. All 2D NumPy arrays must be of the same dimenstions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>avg_frame</strong><span class="classifier">numpy.typing.ArrayLike</span></dt><dd><p>A single 2D NumPy array representing a pairwise distance matrix where each
position i,j is the average distance from residue i to j across all matrices
in frames.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.get_residue_distance_for_trajectory" title="stacker.pairwise_distance.get_residue_distance_for_trajectory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_residue_distance_for_trajectory</span></code></a></dt><dd><p>Calculates System Stacking Fingerprints (SSFs) for all residues across all frames of a trajectory</p>
</dd>
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.system_stacking_fingerprints" title="stacker.pairwise_distance.system_stacking_fingerprints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">system_stacking_fingerprints</span></code></a></dt><dd><p>Alias for get_residue_distance_for_trajectory</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="s1">&#39;stacker/testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">residues_desired</span> <span class="o">=</span> <span class="s1">&#39;2-5,13-16,23-31,46-51,65-76,88-104,122-141,164-175,184-198,288-289,401-415,420-430&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssfs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">get_residue_distance_for_trajectory</span><span class="p">(</span><span class="n">filtered_traj</span><span class="p">,</span> <span class="n">frames</span> <span class="o">=</span> <span class="s1">&#39;1-3&#39;</span><span class="p">,</span> <span class="n">write_output</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_ssf</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">get_frame_average</span><span class="p">(</span><span class="n">ssfs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_ssf</span><span class="o">.</span><span class="n">shape</span>
<span class="go">[FILL]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.pairwise_distance.get_top_stacking">
<span class="sig-name descname"><span class="pre">get_top_stacking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_csv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_adjacent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/pairwise_distance.html#get_top_stacking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.pairwise_distance.get_top_stacking" title="Link to this definition">#</a></dt>
<dd><p>Returns top stacking residue pairs for a given System Stacking Fingerprint (SSF)</p>
<p>Given a trajectory and a SSF made from <cite>get_residue_distance_for_frame()</cite> or <cite>get_frame_average()</cite>
prints the residue pairings with the strongest stacking events (ie. the residue pairings
with center of geometry distance closest to 3.5Å).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>trajectory</strong><span class="classifier">md.Trajectory</span></dt><dd><p>trajectory used to get the stacking fingerprint</p>
</dd>
<dt><strong>matrix</strong><span class="classifier">typing.ArrayLike</span></dt><dd><p>Single-frame SSF created by get_residue_distance_for_frame() or get_frame_average()</p>
</dd>
<dt><strong>output_csv</strong><span class="classifier">str, default = ‘’,</span></dt><dd><p>output filename of the tab-separated txt file to write data to. If empty, data printed to standard output</p>
</dd>
<dt><strong>n_events</strong><span class="classifier">int, default = 5</span></dt><dd><p>maximum number of stacking events to display, if -1 display all residue pairings</p>
</dd>
<dt><strong>include_adjacent</strong><span class="classifier">bool, default = False</span></dt><dd><p>True if adjacent residues should be included in the printed output</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.get_residue_distance_for_frame" title="stacker.pairwise_distance.get_residue_distance_for_frame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_residue_distance_for_frame</span></code></a></dt><dd><p>Calculates System Stacking Fingerprint (SSF) between all residues in a given frame.</p>
</dd>
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.get_residue_distance_for_trajectory" title="stacker.pairwise_distance.get_residue_distance_for_trajectory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_residue_distance_for_trajectory</span></code></a></dt><dd><p>Calculates System Stacking Fingerprints (SSFs) for all residues across all frames of a trajectory</p>
</dd>
<dt><a class="reference internal" href="stacker.pairwise_distance.html#stacker.pairwise_distance.system_stacking_fingerprints" title="stacker.pairwise_distance.system_stacking_fingerprints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">system_stacking_fingerprints</span></code></a></dt><dd><p>Alias for get_residue_distance_for_trajectory</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>We can calculate the stacking events for a single frame:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="s1">&#39;stacker/testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssf</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">get_residue_distance_for_frame</span><span class="p">(</span><span class="n">filtered_traj</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">write_output</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssf</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(252,252)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">get_top_stacking</span><span class="p">(</span><span class="n">filtered_traj</span><span class="p">,</span> <span class="n">ssf</span><span class="p">)</span>
<span class="go">Row     Column  Value</span>
<span class="go">197     195     3.50</span>
<span class="go">420     413     3.51</span>
<span class="go">94      127     3.51</span>
<span class="go">93      130     3.53</span>
<span class="go">117     108     3.38</span>
</pre></div>
</div>
<p>Or we can get most residue pairs that had the most stacking across many frames of a trajectory:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;stacker/testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="s1">&#39;stacker/testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                            <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssfs</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">get_residue_distance_for_trajectory</span><span class="p">(</span><span class="n">filtered_traj</span><span class="p">,</span> <span class="n">frames</span> <span class="o">=</span> <span class="s1">&#39;1-3&#39;</span><span class="p">,</span> <span class="n">write_output</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_ssf</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">get_frame_average</span><span class="p">(</span><span class="n">ssfs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_ssf</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(252, 252)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">get_top_stacking</span><span class="p">(</span><span class="n">filtered_traj</span><span class="p">,</span> <span class="n">ssf</span><span class="p">)</span>
<span class="go">Row     Column  Value</span>
<span class="go">130     93      3.56</span>
<span class="go">108     117     3.44</span>
<span class="go">195     197     3.61</span>
<span class="go">127     94      3.65</span>
<span class="go">47      167     3.66</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.pairwise_distance.increment_residue">
<span class="sig-name descname"><span class="pre">increment_residue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residue_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/pairwise_distance.html#increment_residue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.pairwise_distance.increment_residue" title="Link to this definition">#</a></dt>
<dd><p>Increments residue ID by 1</p>
<p>Useful when converting from mdtraj 0-index residue naming to 1-indexed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>residue_id</strong><span class="classifier">str</span></dt><dd><p>The residue id given by trajectory.topology.residue(i)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>incremented_id</strong><span class="classifier">str</span></dt><dd><p>The residue id with the sequence number increased by 1</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">increment_residue</span><span class="p">(</span><span class="s1">&#39;G43&#39;</span><span class="p">)</span>
<span class="go">&#39;G44&#39;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-stacker.residue_movement">
<span id="stacker-residue-movement-module"></span><h2>stacker.residue_movement module<a class="headerlink" href="#module-stacker.residue_movement" title="Link to this heading">#</a></h2>
<p>Create and Analyze Pairwise Stacking Fingerprints (PSFs)</p>
<p>This module contains the functions to create and analyze Pairwise
Stacking Fingerprints. It allows the user to generate Polar Scatterplots
and Heatmaps of one residue movement relative to the other.</p>
<p>This pipeline takes a pdb file with multiple frames and two residues. 
It then calculates the r, rho, and theta values at each frame
as defined in the Bottaro paper (<a class="reference external" href="https://doi.org/10.1093/nar/gku972">https://doi.org/10.1093/nar/gku972</a>), 
and exports these values to a .csv file.</p>
<dl class="py function">
<dt class="sig sig-object py" id="stacker.residue_movement.collect_atom_locations_by_frame">
<span class="sig-name descname"><span class="pre">collect_atom_locations_by_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/residue_movement.html#collect_atom_locations_by_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.residue_movement.collect_atom_locations_by_frame" title="Link to this definition">#</a></dt>
<dd><p>Creates a list of all atom locations for a particular atom and residue number per frame.</p>
<p>Curates a list coords_by_frame where coords_by_frame[i] is the (x, y, z) positions 
of a provided <cite>atom_id</cite> in a residue <cite>residue_num</cite> at the ith frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>traj</strong><span class="classifier">md.Trajectory</span></dt><dd><p>Trajectory to analyze.</p>
</dd>
<dt><strong>residue_num</strong><span class="classifier">int</span></dt><dd><p>The 0-indexed residue number of the residue where <cite>atom_id</cite> is found (PDB Column 5).</p>
</dd>
<dt><strong>atom_id</strong><span class="classifier">str</span></dt><dd><p>The name of the atom to get coordinates for (PDB Column 2).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>coords_by_frame</strong><span class="classifier">list</span></dt><dd><p>List of (x, y, z) coordinates of <cite>atom_id</cite> in <cite>residue_num</cite> for each frame.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="stacker.residue_movement.html#stacker.residue_movement.Base" title="stacker.residue_movement.Base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Base</span></code></a></dt><dd><p>Python Class that represents a nucleotide base</p>
</dd>
<dt><a class="reference internal" href="stacker.residue_movement.html#stacker.residue_movement.calculate_bottaro_values_for_frame" title="stacker.residue_movement.calculate_bottaro_values_for_frame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_bottaro_values_for_frame</span></code></a></dt><dd><p>Calculates the r, rho, and theta values as expressed in the Bottaro paper.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p><cite>residue_num</cite> must be 0-indexed to match how mdtraj.Trajectory indexes residues.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_traj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">filter_traj</span><span class="p">(</span><span class="s1">&#39;testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                             <span class="s1">&#39;testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop&#39;</span><span class="p">,</span> 
<span class="gp">... </span>                             <span class="n">atomnames_desired</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span><span class="s1">&#39;C6&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">&gt;&gt;&gt;</span> <span class="n">st</span><span class="o">.</span><span class="n">collect_atom_locations_by_frame</span><span class="p">(</span><span class="n">filtered_traj</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;C2&quot;</span><span class="p">)</span>
<span class="go">[(58.794, 59.636, 49.695), (59.185005, 58.797, 50.137), (59.379, 58.553005, 49.853), </span>
<span class="go">(58.76, 59.068, 49.681), (59.003, 59.054, 49.878002), (59.049, 58.967, 50.051), </span>
<span class="go">(59.219, 58.476006, 49.948), (58.948, 58.588005, 50.085), (58.922, 58.747, 49.766003), </span>
<span class="go">(59.124, 58.916, 49.978004)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.residue_movement.calc_center_3pts">
<span class="sig-name descname"><span class="pre">calc_center_3pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/residue_movement.html#calc_center_3pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.residue_movement.calc_center_3pts" title="Link to this definition">#</a></dt>
<dd><p>Finds the average x, y, z position of three x, y, z Vectors.</p>
<p>Takes in three Vectors generated using the <cite>pdb.xyz</cite> method and finds their center. Works 
with three points that make up a triangle (like those within a 6-member ring).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a</strong><span class="classifier">Vector</span></dt><dd><p>x, y, z coordinates of the first point.</p>
</dd>
<dt><strong>b</strong><span class="classifier">Vector</span></dt><dd><p>x, y, z coordinates of the second point.</p>
</dd>
<dt><strong>c</strong><span class="classifier">Vector</span></dt><dd><p>x, y, z coordinates of the third point.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>midpoint</strong><span class="classifier">Vector</span></dt><dd><p>One Vector with (x, y, z) coordinates at the center of the three input Vectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stacker.residue_movement.Base">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c2_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c4_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c6_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">midpoint_coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/residue_movement.html#Base"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.residue_movement.Base" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a nucleotide base with x, y, z coordinates for C2, C4, and C6 atoms,
and their average position at a single frame.</p>
<p>This class defines a data type ‘Base’ that consists of coordinates for the atoms
C2, C4, and C6, as well as the midpoint of these atoms for a single residue at a single frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>c2_coords</strong><span class="classifier">Vector</span></dt><dd><p>(x, y, z) coordinates for the atom C2.</p>
</dd>
<dt><strong>c4_coords</strong><span class="classifier">Vector</span></dt><dd><p>(x, y, z) coordinates for the atom C4.</p>
</dd>
<dt><strong>c6_coords</strong><span class="classifier">Vector</span></dt><dd><p>(x, y, z) coordinates for the atom C6.</p>
</dd>
<dt><strong>midpoint_coords</strong><span class="classifier">Vector</span></dt><dd><p>(x, y, z) coordinates representing the midpoint of C2, C4, and C6.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stacker.residue_movement.Base.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c2_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c4_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c6_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">midpoint_coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/residue_movement.html#Base.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.residue_movement.Base.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize a Base instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>c2_coords</strong><span class="classifier">tuple</span></dt><dd><p>(x, y, z) coordinates for C2.</p>
</dd>
<dt><strong>c4_coords</strong><span class="classifier">tuple</span></dt><dd><p>(x, y, z) coordinates for C4.</p>
</dd>
<dt><strong>c6_coords</strong><span class="classifier">tuple</span></dt><dd><p>(x, y, z) coordinates for C6.</p>
</dd>
<dt><strong>midpoint_coords</strong><span class="classifier">tuple</span></dt><dd><p>(x, y, z) coordinates for the midpoint.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.residue_movement.create_base_from_coords_list">
<span class="sig-name descname"><span class="pre">create_base_from_coords_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C2_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C4_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C6_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">midpoint_coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/residue_movement.html#create_base_from_coords_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.residue_movement.create_base_from_coords_list" title="Link to this definition">#</a></dt>
<dd><p>Combines C2, C4, C6 positions with midpoint positions for a given frame.</p>
<p>Takes a frame (0-indexed) and outputs a Base instance with the x, y, z locations of C2, C4, C6, and midpoint 
of the same residue at that frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame</strong><span class="classifier">int</span></dt><dd><p>Frame number (0-indexed).</p>
</dd>
<dt><strong>C2_coords</strong><span class="classifier">list</span></dt><dd><p>List of (x, y, z) coordinates of C2 atom in some residue for each frame.</p>
</dd>
<dt><strong>C4_coords</strong><span class="classifier">list</span></dt><dd><p>List of (x, y, z) coordinates of C4 atom in some residue for each frame.</p>
</dd>
<dt><strong>C6_coords</strong><span class="classifier">list</span></dt><dd><p>List of (x, y, z) coordinates of C6 atom in some residue for each frame.</p>
</dd>
<dt><strong>midpoint_coords</strong><span class="classifier">list</span></dt><dd><p>List of (x, y, z) coordinates of the midpoint of residue for each frame.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Base</dt><dd><p>An instance of Base with coordinates at the specified frame.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.residue_movement.correct_theta_sign">
<span class="sig-name descname"><span class="pre">correct_theta_sign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/residue_movement.html#correct_theta_sign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.residue_movement.correct_theta_sign" title="Link to this definition">#</a></dt>
<dd><p>Corrects the sign of an angle theta with the x-axis within a plane defined by a given y-axis.</p>
<p>When calculating the angle theta between two vectors in 3D space, once the vectors move
&gt;180 degrees apart, the angle becomes the shortest path. To have 360 degrees of freedom, we calculate
theta within the plane by checking if it faces the same direction as a vector y, and correcting
otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rho</strong><span class="classifier">Vector</span></dt><dd><p>The vector compared to the x-axis to form theta.</p>
</dd>
<dt><strong>y_axis</strong><span class="classifier">Vector</span></dt><dd><p>Directional vector to define a plane with x-axis; orthogonal to x-axis.</p>
</dd>
<dt><strong>theta</strong><span class="classifier">float</span></dt><dd><p>The calculated angle of rho with x-axis to be corrected.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>Theta as calculated on the plane.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.residue_movement.calculate_bottaro_values_for_frame">
<span class="sig-name descname"><span class="pre">calculate_bottaro_values_for_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perspective_base_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewed_midpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/residue_movement.html#calculate_bottaro_values_for_frame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.residue_movement.calculate_bottaro_values_for_frame" title="Link to this definition">#</a></dt>
<dd><p>Calculates the r, rho, and theta values as expressed in the Bottaro paper.</p>
<p>Calculates the r, rho, and theta values between two nucleotides in a single frame
as presented in Figure 1 of Bottaro et. al (<a class="reference external" href="https://doi.org/10.1093/nar/gku972">https://doi.org/10.1093/nar/gku972</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>perspective_base_coords</strong><span class="classifier">Base</span></dt><dd><p>List of the x, y, z coords of C2, C4, C6 and their midpoint for 
the perspective residue in a single frame.</p>
</dd>
<dt><strong>viewed_midpoint</strong><span class="classifier">Vector</span></dt><dd><p>x, y, z position of the midpoint of the viewed nucleotide at the same frame.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list</dt><dd><p>A list containing 3 floats from Bottaro; structure: [r_dist, rho_dist, theta].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.residue_movement.write_bottaro_to_csv">
<span class="sig-name descname"><span class="pre">write_bottaro_to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_csv_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perspective_residue_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewed_residue_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res1_atom_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res2_atom_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'C2',</span> <span class="pre">'C4',</span> <span class="pre">'C6'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/residue_movement.html#write_bottaro_to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.residue_movement.write_bottaro_to_csv" title="Link to this definition">#</a></dt>
<dd><p>Write the Bottaro r, rho, and theta values from a trajectory PDB to a CSV.</p>
<p>Calculates the r, rho, and theta values as described in Bottaro et al. from a
perspective nucleotide residue to a viewed nucleotide residue per frame. Writes the 
results to a CSV file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>pdb_filename</strong><span class="classifier">str</span></dt><dd><p>Name of PDB containing information for ONLY two residues (perspective and viewed
nucleotide) at each frame.</p>
</dd>
<dt><strong>output_csv_name</strong><span class="classifier">str</span></dt><dd><p>Filename of CSV file to write to.</p>
</dd>
<dt><strong>perspective_residue_num</strong><span class="classifier">int, default = -1</span></dt><dd><p>Residue index of the perspective residue whose plane to project onto (0-/1-index changed by
index variable, default 1-indexed). If -1, a 2-residue PDB is assumed and perspective id is
the first res_id.</p>
</dd>
<dt><strong>viewed_residue_num</strong><span class="classifier">int, default = -1</span></dt><dd><p>Residue index of the viewed residue whose midpoint to project to pers_res plane (0-/1-index changed by
index variable, default 1-indexed). If -1, a 2-residue PDB is assumed and viewed id is
the second res_id.</p>
</dd>
<dt><strong>res1_atom_names</strong><span class="classifier">set, default = {“C2”, “C4”, “C6”}</span></dt><dd><p>Set of the atom names (e.g., “C2”, “C4”, “C6”) to use from
residue 1 to find center of geometry for perspective nucleotide.</p>
</dd>
<dt><strong>res2_atom_names</strong><span class="classifier">set, default = {“C2”, “C4”, “C6”}</span></dt><dd><p>Set of the atom names (e.g., “C2”, “C4”, “C6”) to use from
residue 2 to find center of geometry for viewed nucleotide.</p>
</dd>
<dt><strong>index</strong><span class="classifier">int, default = 1</span></dt><dd><p>Index of the residues. 1-indexed (default) means residue ids start at 1.
cpptraj uses 1-indexed residues. mdtraj PDB outputs will be 0-indexed.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] Sandro Bottaro, Francesco Di Palma, Giovanni Bussi, The role of nucleobase interactions in 
RNA structure and dynamics, Nucleic Acids Research, Volume 42, Issue 21, 1 December 2014, 
Pages 13306–13314, <a class="reference external" href="https://doi.org/10.1093/nar/gku972">https://doi.org/10.1093/nar/gku972</a></p>
</dd></dl>

</section>
<section id="module-stacker.vector">
<span id="stacker-vector-module"></span><h2>stacker.vector module<a class="headerlink" href="#module-stacker.vector" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stacker.vector.Vector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/vector.html#Vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.vector.Vector" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a 3D vector with x, y, and z components.</p>
<p>This class defines a data type ‘Vector’ that represents a 3D vector with
x, y, and z components, assuming the vector originates at the origin (0,0,0).</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">float</span></dt><dd><p>The x-component of the vector.</p>
</dd>
<dt><strong>y</strong><span class="classifier">float</span></dt><dd><p>The y-component of the vector.</p>
</dd>
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>The z-component of the vector.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#stacker.vector.Vector.calculate_cross_product" title="stacker.vector.Vector.calculate_cross_product"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_cross_product</span></code></a>(b)</p></td>
<td><p>Calculate the cross product of two vectors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stacker.vector.Vector.calculate_projection" title="stacker.vector.Vector.calculate_projection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_projection</span></code></a>(b)</p></td>
<td><p>Calculate the projection of this vector onto vector b.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stacker.vector.Vector.magnitude" title="stacker.vector.Vector.magnitude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">magnitude</span></code></a>()</p></td>
<td><p>Calculate the magnitude (length) of the vector.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stacker.vector.Vector.scale" title="stacker.vector.Vector.scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale</span></code></a>(a)</p></td>
<td><p>Scale the vector by a scalar a.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stacker.vector.Vector.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/vector.html#Vector.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.vector.Vector.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize a Vector instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">float</span></dt><dd><p>The x-component of the vector.</p>
</dd>
<dt><strong>y</strong><span class="classifier">float</span></dt><dd><p>The y-component of the vector.</p>
</dd>
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>The z-component of the vector.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.vector.Vector.calculate_cross_product">
<span class="sig-name descname"><span class="pre">calculate_cross_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/vector.html#Vector.calculate_cross_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.vector.Vector.calculate_cross_product" title="Link to this definition">#</a></dt>
<dd><p>Calculate the cross product of two vectors.</p>
<p>Calculates the cross product of two vectors, which is the unit vector that is 
perpendicular to both vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong><span class="classifier">Vector</span></dt><dd><p>The second vector to calculate the cross product with.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Vector</dt><dd><p>The resulting vector from the cross product.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.vector.Vector.magnitude">
<span class="sig-name descname"><span class="pre">magnitude</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/vector.html#Vector.magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.vector.Vector.magnitude" title="Link to this definition">#</a></dt>
<dd><p>Calculate the magnitude (length) of the vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>float</dt><dd><p>The magnitude (length) of the vector.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.vector.Vector.calculate_projection">
<span class="sig-name descname"><span class="pre">calculate_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/vector.html#Vector.calculate_projection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.vector.Vector.calculate_projection" title="Link to this definition">#</a></dt>
<dd><p>Calculate the projection of this vector onto vector b.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong><span class="classifier">Vector</span></dt><dd><p>The vector to project onto.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Vector</dt><dd><p>The resulting vector from the projection.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.vector.Vector.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/vector.html#Vector.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.vector.Vector.scale" title="Link to this definition">#</a></dt>
<dd><p>Scale the vector by a scalar a.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a</strong><span class="classifier">float</span></dt><dd><p>The scalar to scale the vector by.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Vector</dt><dd><p>The scaled vector.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-stacker.visualization">
<span id="stacker-visualization-module"></span><h2>stacker.visualization module<a class="headerlink" href="#module-stacker.visualization" title="Link to this heading">#</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="stacker.visualization.NoResidues">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NoResidues</span></span><a class="reference internal" href="_modules/stacker/visualization.html#NoResidues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.visualization.NoResidues" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="stacker.visualization.NoResidues.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.visualization.NoResidues.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.visualization.NoResidues.add_note">
<span class="sig-name descname"><span class="pre">add_note</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.visualization.NoResidues.add_note" title="Link to this definition">#</a></dt>
<dd><p>Exception.add_note(note) –
add a note to the exception</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stacker.visualization.NoResidues.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#stacker.visualization.NoResidues.args" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.visualization.NoResidues.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.visualization.NoResidues.with_traceback" title="Link to this definition">#</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.visualization.create_parent_directories">
<span class="sig-name descname"><span class="pre">create_parent_directories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile_prefix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/visualization.html#create_parent_directories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.visualization.create_parent_directories" title="Link to this definition">#</a></dt>
<dd><p>Creates necessary parent directories to write an outfile given a prefix</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.visualization.create_axis_labels">
<span class="sig-name descname"><span class="pre">create_axis_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_indicies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tick_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/visualization.html#create_axis_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.visualization.create_axis_labels" title="Link to this definition">#</a></dt>
<dd><p>Designates the axis labels to use in the pairwise plot.</p>
<p>Returns the x-axis tick positions and labels to use on the ticks based on the 
residues used in a specific pairwise analysis. Meant to be used when many 
disjoint sets of residue indices are used. Ticks will be present every <cite>tick_distance</cite> 
residues in a collection of adjacent residues, and a tick will exist at both
ends of any consecutive residue sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>res_indicies</strong><span class="classifier">list</span></dt><dd><p>The list of residue indices used in the pairwise analysis.</p>
</dd>
<dt><strong>tick_distance</strong><span class="classifier">int, default = 10</span></dt><dd><p>Distance between ticks in blocks of consecutive residues.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>tick_locations</strong><span class="classifier">list</span></dt><dd><p>List of tick positions (0-based) to place labels on in the axes.</p>
</dd>
<dt><strong>tick_labels</strong><span class="classifier">list</span></dt><dd><p>List of labels to place at the adjacent tick locations.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">create_axis_labels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
<span class="go">[0, 10, 12, 13, 15], [0, 10, 12, 98, 100]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">create_axis_labels</span><span class="p">([</span><span class="mi">94</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">408</span><span class="p">,</span><span class="mi">409</span><span class="p">,</span><span class="mi">410</span><span class="p">,</span><span class="mi">411</span><span class="p">,</span><span class="mi">412</span><span class="p">,</span><span class="mi">413</span><span class="p">,</span><span class="mi">414</span><span class="p">,</span><span class="mi">415</span><span class="p">,</span><span class="mi">416</span><span class="p">,</span><span class="mi">417</span><span class="p">,</span><span class="mi">418</span><span class="p">,</span><span class="mi">419</span><span class="p">,</span><span class="mi">420</span><span class="p">,</span><span class="mi">421</span><span class="p">,</span><span class="mi">422</span><span class="p">,</span><span class="mi">423</span><span class="p">,</span><span class="mi">424</span><span class="p">,</span><span class="mi">425</span><span class="p">,</span><span class="mi">426</span><span class="p">,</span><span class="mi">427</span><span class="p">,</span><span class="mi">428</span><span class="p">])</span>
<span class="go">[0, 6, 7, 17, 27], [94, 100, 408, 418, 428]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.visualization.display_arrays_as_video">
<span class="sig-name descname"><span class="pre">display_arrays_as_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numpy_arrays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_indicies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seconds_per_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tick_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bellcurve'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/visualization.html#display_arrays_as_video"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.visualization.display_arrays_as_video" title="Link to this definition">#</a></dt>
<dd><p>Displays list/array of 2D NumPy arrays as matrix heatmaps.</p>
<p>Takes list/array of 2D NumPy arrays and treats them as frames 
in a video, filling in a grid at position i, j by the value 
at i, j in the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>numpy_arrays</strong><span class="classifier">array_like</span></dt><dd><p>List or array of 2D NumPy arrays.</p>
</dd>
<dt><strong>res_indicies</strong><span class="classifier">list</span></dt><dd><p>The list of residue indices used in the pairwise analysis.</p>
</dd>
<dt><strong>seconds_per_frame</strong><span class="classifier">int, default = 10</span></dt><dd><p>Number of seconds to display each matrix for.</p>
</dd>
<dt><strong>tick_distance</strong><span class="classifier">int, default = 10</span></dt><dd><p>Distance between ticks in blocks of consecutive residues.</p>
</dd>
<dt><strong>outfile</strong><span class="classifier">str</span></dt><dd><p>Image output filepath to write a single SSF to. Format inferred from file extension.
png, pdf, ps, eps, and svg supported.</p>
</dd>
<dt><strong>outfile_prefix</strong><span class="classifier">str</span></dt><dd><p>Prefix for image filepath to write multiple frames to. Format inferred from file extension.
png, pdf, ps, eps, and svg supported.</p>
</dd>
<dt><strong>scale_limits</strong><span class="classifier">tuple, default = (0, 7)</span></dt><dd><p>Limits of the color scale.</p>
</dd>
<dt><strong>scale_style</strong><span class="classifier">str, default = ‘bellcurve’</span></dt><dd><p>Style of color scale. {bellcurve, gradient}</p>
</dd>
<dt><strong>xy_line</strong><span class="classifier">bool, default = True</span></dt><dd><p>Draw x = y line to separate matrix halves.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>Displays video of NumPy arrays.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.visualization.set_polar_grid">
<span class="sig-name descname"><span class="pre">set_polar_grid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/visualization.html#set_polar_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.visualization.set_polar_grid" title="Link to this definition">#</a></dt>
<dd><p>Set up axes for polar plots.</p>
<p>Creates polar plot background for two-residue movement comparison
with theta 0 to 360, a radial maximum of 15 Angstroms, and a visualization 
of the perspective residue at the center.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>None</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ax</strong><span class="classifier">matplotlib.projections.polar.PolarAxes</span></dt><dd><p>Axis object for the created polar plot.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.visualization.visualize_two_residue_movement_scatterplot">
<span class="sig-name descname"><span class="pre">visualize_two_residue_movement_scatterplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/visualization.html#visualize_two_residue_movement_scatterplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.visualization.visualize_two_residue_movement_scatterplot" title="Link to this definition">#</a></dt>
<dd><p>Creates scatterplot of two-residue movement relative to each other.</p>
<p>Takes the data created in residue_movement and visualizes it as a polar coordinate
scatterplot similar to the Figure D link in Proposal Feature 4.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>csv_filepath</strong><span class="classifier">str</span></dt><dd><p>Filepath to csv file containing data on the movement
of two residues relative to each other (r, rho, and theta values). Created
in residue_movement.</p>
</dd>
<dt><strong>plot_outfile</strong><span class="classifier">str</span></dt><dd><p>Filepath of the image file to write to. Format inferred from file extension.
png, pdf, ps, eps, and svg supported.</p>
</dd>
<dt><strong>frame_list</strong><span class="classifier">set, default = {}</span></dt><dd><p>Set of frames to use in csv, if empty use all frames.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.visualization.visualize_two_residue_movement_heatmap">
<span class="sig-name descname"><span class="pre">visualize_two_residue_movement_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker/visualization.html#visualize_two_residue_movement_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.visualization.visualize_two_residue_movement_heatmap" title="Link to this definition">#</a></dt>
<dd><p>Creates heatmap of two-residue movement relative to each other.</p>
<p>2D shaded contour plot of the density of points in the 
visualize_two_residue_movement_scatterplot() scatterplot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>csv_filepath</strong><span class="classifier">str</span></dt><dd><p>Filepath to csv file containing data on the movement
of two residues relative to each other (r, rho, and theta values). Created
in residue_movement.</p>
</dd>
<dt><strong>plot_outfile</strong><span class="classifier">str</span></dt><dd><p>Filepath of the image file to write to. Format inferred from file extension.
png, pdf, ps, eps, and svg supported.</p>
</dd>
<dt><strong>frame_list</strong><span class="classifier">set, default = {}</span></dt><dd><p>Set of frames to use in csv, if empty use all frames.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-stacker">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-stacker" title="Link to this heading">#</a></h2>
<p>Command Line Options for StACKER</p>
<p>This module contains the Python routines called when StACKER
is run in the command line.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="stacker.InvalidRoutine">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InvalidRoutine</span></span><a class="reference internal" href="_modules/stacker.html#InvalidRoutine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.InvalidRoutine" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Specified command line routine was invalid</p>
<p>This is raised when the <cite>stacker -s ROUTINE</cite> was given
an invalid ROUTINE.</p>
<p class="rubric">Examples</p>
<p>Command Line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ stacker -s blah
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stacker.InvalidRoutine.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.InvalidRoutine.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.InvalidRoutine.add_note">
<span class="sig-name descname"><span class="pre">add_note</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.InvalidRoutine.add_note" title="Link to this definition">#</a></dt>
<dd><p>Exception.add_note(note) –
add a note to the exception</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stacker.InvalidRoutine.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#stacker.InvalidRoutine.args" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.InvalidRoutine.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.InvalidRoutine.with_traceback" title="Link to this definition">#</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="stacker.ResEmpty">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ResEmpty</span></span><a class="reference internal" href="_modules/stacker.html#ResEmpty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.ResEmpty" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>No Residues to subset to were provided</p>
<p>This is raised when a routine is given an invalid
number of residues to subset to.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">fiter_traj_routine</span></code></dt><dd></dd>
<dt><a class="reference internal" href="#stacker.bottaro_routine" title="stacker.bottaro_routine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottaro_routine</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Command Line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ stacker -s filter_traj -r -a C2,C4,C6
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stacker.ResEmpty.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.ResEmpty.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.ResEmpty.add_note">
<span class="sig-name descname"><span class="pre">add_note</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.ResEmpty.add_note" title="Link to this definition">#</a></dt>
<dd><p>Exception.add_note(note) –
add a note to the exception</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stacker.ResEmpty.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#stacker.ResEmpty.args" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.ResEmpty.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.ResEmpty.with_traceback" title="Link to this definition">#</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="stacker.AtomEmpty">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AtomEmpty</span></span><a class="reference internal" href="_modules/stacker.html#AtomEmpty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.AtomEmpty" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>No Atomnames to subset to were provided</p>
<p>This is raised when a routine is given an invalid
number of atomnames to subset to.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">fiter_traj_routine</span></code></dt><dd></dd>
<dt><a class="reference internal" href="#stacker.bottaro_routine" title="stacker.bottaro_routine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bottaro_routine</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Command Line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ stacker -s filter_traj -a -r 426,427  
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stacker.AtomEmpty.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.AtomEmpty.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.AtomEmpty.add_note">
<span class="sig-name descname"><span class="pre">add_note</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.AtomEmpty.add_note" title="Link to this definition">#</a></dt>
<dd><p>Exception.add_note(note) –
add a note to the exception</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stacker.AtomEmpty.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#stacker.AtomEmpty.args" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.AtomEmpty.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.AtomEmpty.with_traceback" title="Link to this definition">#</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="stacker.FrameEmpty">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FrameEmpty</span></span><a class="reference internal" href="_modules/stacker.html#FrameEmpty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.FrameEmpty" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>No Frames present in trajectory</p>
<dl class="py method">
<dt class="sig sig-object py" id="stacker.FrameEmpty.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.FrameEmpty.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.FrameEmpty.add_note">
<span class="sig-name descname"><span class="pre">add_note</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.FrameEmpty.add_note" title="Link to this definition">#</a></dt>
<dd><p>Exception.add_note(note) –
add a note to the exception</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stacker.FrameEmpty.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#stacker.FrameEmpty.args" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stacker.FrameEmpty.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#stacker.FrameEmpty.with_traceback" title="Link to this definition">#</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.block_printing">
<span class="sig-name descname"><span class="pre">block_printing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#block_printing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.block_printing" title="Link to this definition">#</a></dt>
<dd><p>Disable printing to standard output</p>
<p class="rubric">References</p>
<p>[1] <a class="reference external" href="https://stackoverflow.com/a/8391735">https://stackoverflow.com/a/8391735</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.enable_printing">
<span class="sig-name descname"><span class="pre">enable_printing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#enable_printing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.enable_printing" title="Link to this definition">#</a></dt>
<dd><p>Enable printing to standard output</p>
<p class="rubric">References</p>
<p>[1] <a class="reference external" href="https://stackoverflow.com/a/8391735">https://stackoverflow.com/a/8391735</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.run_python_command">
<span class="sig-name descname"><span class="pre">run_python_command</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#run_python_command"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.run_python_command" title="Link to this definition">#</a></dt>
<dd><p>Reads the user’s passed in command line and runs the command</p>
<p>Reads the command line input, runs the associated command with the
added flags.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.convert_to_python_command">
<span class="sig-name descname"><span class="pre">convert_to_python_command</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#convert_to_python_command"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.convert_to_python_command" title="Link to this definition">#</a></dt>
<dd><p>Converts a parsed command to use to the correct subroutine and runs the routine</p>
<p>Converts the specified script to a python command and runs it with the associated inputs
based on the flags.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.filter_traj_routine">
<span class="sig-name descname"><span class="pre">filter_traj_routine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#filter_traj_routine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.filter_traj_routine" title="Link to this definition">#</a></dt>
<dd><p>Executes the routine for filtering an input trajectory file and converting it to a PDB file.</p>
<p>This function uses provided command-line arguments to call <cite>filter_traj_to_pdb()</cite> 
with specified inputs, such as the trajectory file, topology file, output file location, 
residues to retain, and atom names to retain.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ResEmpty</dt><dd><p>If the <cite>–residues</cite> argument is not provided.</p>
</dd>
<dt>AtomEmpty</dt><dd><p>If the <cite>–atom_names</cite> argument is not provided.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj_to_pdb</span></code></dt><dd><p>The core function that performs the trajectory filtering and PDB generation.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The <cite>args.residues</cite> argument should be a list of residue indices to retain.</p></li>
<li><p>The <cite>args.atom_names</cite> argument should be a comma-separated string of atom names to retain.</p></li>
<li><p>Output directories are created automatically if they do not exist.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Command-line usage with sample arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python3 stacker.py 
    -s filter_traj 
    -trj testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd 
    -top testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop 
    -o testing/command_line_tests/filter/5JUP_N2_tUAG_aCUA_+1GCU_nowat_mdcrd.pdb 
    -r 426,427 -a C2,C4,C6
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.bottaro_routine">
<span class="sig-name descname"><span class="pre">bottaro_routine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#bottaro_routine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.bottaro_routine" title="Link to this definition">#</a></dt>
<dd><p>Executes the residue movement routine to generate Bottaro values for a trajectory.</p>
<p>This routine calculates the <cite>r</cite>, <cite>rho</cite>, and <cite>theta</cite> values for each frame of a PDB trajectory 
between two specified residues and stores them in a CSV file. Optionally, it visualizes the 
movement using heatmaps or scatter plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>None</strong></dt><dd><p>The routine relies on global <cite>args</cite>, which must be set via command-line arguments or 
equivalent argument parsing.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>AtomEmpty</dt><dd><p>If required atom names or residue indices are not provided.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj_to_pdb</span></code></dt><dd><p>Filters trajectory and generates an intermediate PDB.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_bottaro_to_csv</span></code></dt><dd><p>Writes residue movement calculations to a CSV.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize_two_residue_movement_heatmap</span></code></dt><dd><p>Creates a heatmap for residue movement.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize_two_residue_movement_scatterplot</span></code></dt><dd><p>Creates a scatter plot for residue movement.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p><cite>args.trajectory</cite> and <cite>args.topology</cite> are required for generating an intermediate PDB if one 
is not already provided.</p></li>
<li><p>Supports heatmap and scatter plot visualizations for residue movement.</p></li>
<li><p>Removes intermediate files (<cite>pdb</cite> and <cite>csv</cite>) if <cite>–no_inter</cite> flag is specified.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Command-line usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python3 stacker.py -s bottaro 
    -trj testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd 
    -top testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop 
    -pdb testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat_mdcrd.pdb 
    -o testing/command_line_tests/bottaro/tUAG_aCUA_+1GCU_GC_plot.csv 
    -p 426 -v 427 -pa C2,C4,C6 -va C2,C4,C6 -pt scatter

$ python3 stacker.py -s bottaro 
    -pdb testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat_mdcrd_3200frames.pdb 
    -o testing/command_line_tests/bottaro/tUAG_aCUA_+1GCU_GC_plot_3200frames.csv 
    -p 426 -v 427 -pa C2,C4,C6 -va C2,C4,C6 -pt heat
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.res_distance_routine">
<span class="sig-name descname"><span class="pre">res_distance_routine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#res_distance_routine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.res_distance_routine" title="Link to this definition">#</a></dt>
<dd><p>Calculates the distance between the centers of mass of two specified residues.</p>
<p>This routine filters the trajectory based on the specified residues and atom names, 
and calculates the distances for either a single frame or multiple frames if bootstrapping is enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>None</strong></dt><dd><p>The routine relies on global <cite>args</cite> for all input values.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ResEmpty</dt><dd><p>If fewer or more than two residues are specified, or if no residues are provided.</p>
</dd>
<dt>AtomEmpty</dt><dd><p>If no atom names are provided.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj</span></code></dt><dd><p>Filters the trajectory for the specified residues and atom names.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_residue_distance</span></code></dt><dd><p>Calculates the distance between residues for a given frame.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The <cite>args.residues</cite> argument must contain exactly two residues.</p></li>
<li><p>The <cite>args.atom_names</cite> argument is required to specify the atoms involved in the calculation.</p></li>
<li><p>If the <cite>–bootstrap</cite> argument is provided, distances are calculated across a specified number of randomly sampled frames.</p></li>
<li><p>If no bootstrap is performed, the distance is calculated for a single frame.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Command-line usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python3 stacker.py -s res_distance 
    -trj testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd 
    -top testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop 
    -f 2 --residues 426,427 --atom_names C2,C4,C6
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.system_routine">
<span class="sig-name descname"><span class="pre">system_routine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#system_routine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.system_routine" title="Link to this definition">#</a></dt>
<dd><p>Runs the System Stacking Fingerprint (SSF) routine to generate a single SSF for a specified frame or range of frames.</p>
<p>This routine processes a trajectory to create SSFs based on inter-residue distances and outputs either visualizations 
or raw data for further analysis. The user can provide input fingerprints or generate them from trajectory files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>None</strong></dt><dd><p>The routine relies on global <cite>args</cite> for all input values.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>FileNotFoundError</dt><dd><p>If the specified trajectory or topology file does not exist.</p>
</dd>
<dt>ValueError</dt><dd><p>If the provided input files have incompatible dimensions or unexpected formatting.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj</span></code></dt><dd><p>Filters the trajectory for the specified residues.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_residue_distance_for_trajectory</span></code></dt><dd><p>Computes inter-residue distances for a trajectory.</p>
</dd>
<dt><a class="reference internal" href="#stacker.combine_frames" title="stacker.combine_frames"><code class="xref py py-obj docutils literal notranslate"><span class="pre">combine_frames</span></code></a></dt><dd><p>Combines two SSFs into a single array for comparison.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">display_arrays_as_video</span></code></dt><dd><p>Visualizes SSF arrays and saves them as video files.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If <cite>args.input</cite> is provided, the routine will use pre-calculated fingerprint data.</p></li>
<li><p>If <cite>args.residues</cite> is specified, only those residues are considered in the calculation.</p></li>
<li><p>SSFs can be created for individual frames, a list of frames, or all frames in the trajectory.</p></li>
<li><p>If <cite>args.input_B</cite> is provided, two SSFs are combined for analysis.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Command-line usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python3 stacker.py -s system 
    -trj testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd 
    -top testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop 
    -r 90-215 -fl 1-2 

$ python3 stacker.py -s ssf 
    -trj testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd 
    -top testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop 
    -r 90-215 -fl 1-2 -g 10 
    -o testing/command_line_tests/pairwise/5JUP_N2_tUAG_aCUA_+1GCU_nowat_pairwise_avg_1to2.png 
    -d testing/command_line_tests/pairwise/5JUP_N2_tUAG_aCUA_+1GCU_data_1to2.txt
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.combine_frames">
<span class="sig-name descname"><span class="pre">combine_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames_B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#combine_frames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.combine_frames" title="Link to this definition">#</a></dt>
<dd><p>Combines two 2D numpy arrays (frames_A and frames_B) into a single array.</p>
<p>This function takes two 2D numpy arrays of the same shape and combines them
into a new array. The upper triangular part (excluding the diagonal) of the 
resulting array is filled with the corresponding elements from frames_A, 
while the lower triangular part (including the diagonal) is filled with the 
corresponding elements from frames_B.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frames_A</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>A 2D numpy array.</p>
</dd>
<dt><strong>frames_B</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>A 2D numpy array of the same shape as frames_A.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>A new 2D numpy array with combined elements from frames_A and frames_B.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">stacker</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frames_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frames_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">combine_frames</span><span class="p">(</span><span class="n">frames_A</span><span class="p">,</span> <span class="n">frames_B</span><span class="p">)</span>
<span class="go">array([[9., 2., 3.],</span>
<span class="go">       [6., 5., 6.],</span>
<span class="go">       [3., 2., 1.]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.stack_events_routine">
<span class="sig-name descname"><span class="pre">stack_events_routine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#stack_events_routine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.stack_events_routine" title="Link to this definition">#</a></dt>
<dd><p>Identifies residue pairs with the most π-stacking interactions.</p>
<p>This routine analyzes a molecular dynamics trajectory and identifies residue pairs 
with the smallest center of geometry (COG) distances, typically indicating strong 
π-stacking. It outputs the top <cite>n_events</cite> residue pairings based on user input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>None</strong></dt><dd><p>This function relies on global <cite>args</cite> for input values.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>FileNotFoundError</dt><dd><p>If the trajectory or topology files are not found.</p>
</dd>
<dt>ValueError</dt><dd><p>If input parameters are invalid or incompatible with the data.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_traj</span></code></dt><dd><p>Filters trajectory data based on residue selection.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_top_stacking</span></code></dt><dd><p>Extracts top stacking events from a trajectory.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Command-line usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ stacker -s stack_events 
    -trj testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd 
    -top testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop 
    -r 90-215 -f 1 -n 5

$ stacker -s stack_events 
    -trj testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd 
    -top testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop 
    -r 90-100 -fl 1-10 -n 5

$ stacker -s stack_events 
    -trj testing/first10_5JUP_N2_tUAG_aCUA_+1GCU_nowat.mdcrd 
    -top testing/5JUP_N2_tUAG_aCUA_+1GCU_nowat.prmtop 
    -r 90-215 -n 5 -i testing/command_line_tests/pairwise/5JUP_N2_tUAG_aCUA_+1GCU_data_1to2.txt
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stacker.compare_routine">
<span class="sig-name descname"><span class="pre">compare_routine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/stacker.html#compare_routine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stacker.compare_routine" title="Link to this definition">#</a></dt>
<dd><p>Compares pi-stacking events between two trajectories.</p>
<p>This routine analyzes two trajectory-derived stacking event files and identifies 
residue pairs with the largest change in average distances between the two systems. 
It processes the data, merges it, calculates discrepancies, and outputs the sorted 
results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>None</strong></dt><dd><p>This function relies on global <cite>args</cite> for input values.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>FileNotFoundError</dt><dd><p>If one or both input files are not found.</p>
</dd>
<dt>ValueError</dt><dd><p>If the input files have incompatible formats or lack the required headers.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_row_with_header</span></code></dt><dd><p>Identifies the header row in a data file.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess_df</span></code></dt><dd><p>Prepares the input dataframes for comparison.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pd.merge</span></code></dt><dd><p>Merges the two dataframes for discrepancy calculations.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The input files must contain tab-separated values with the header <cite>Row    Column  Value</cite>.</p></li>
<li><p>Residue pairings are sorted alphabetically before comparison to ensure consistent results.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Command-line usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ stacker -s compare 
    -A /home66/esakkas/STACKER/SCRIPTS/slurmLogs_fingerprint/out_fingerprint_2418986 
    -B /home66/esakkas/STACKER/SCRIPTS/slurmLogs_fingerprint/out_fingerprint_2418997 
    -SA _tUAG_aCUA_+1GCU -SB _tUAG_aCUA_+1CGU
</pre></div>
</div>
</dd></dl>

</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.file_manipulation">stacker.file_manipulation module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction.parse_smart_index"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction.parse_smart_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction.__init__"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction._get_args"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction._get_args()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction._get_kwargs"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction._get_kwargs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.SmartIndexingAction.format_usage"><code class="docutils literal notranslate"><span class="pre">SmartIndexingAction.format_usage()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.filter_traj"><code class="docutils literal notranslate"><span class="pre">filter_traj()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.filter_traj_to_pdb"><code class="docutils literal notranslate"><span class="pre">filter_traj_to_pdb()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.file_manipulation.file_convert"><code class="docutils literal notranslate"><span class="pre">file_convert()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.kmeans">stacker.kmeans module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.read_and_preprocess_data"><code class="docutils literal notranslate"><span class="pre">read_and_preprocess_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.create_kmeans_input"><code class="docutils literal notranslate"><span class="pre">create_kmeans_input()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.plot_pca"><code class="docutils literal notranslate"><span class="pre">plot_pca()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.run_kmeans"><code class="docutils literal notranslate"><span class="pre">run_kmeans()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.plot_silhouette"><code class="docutils literal notranslate"><span class="pre">plot_silhouette()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.kmeans.plot_cluster_trj_data"><code class="docutils literal notranslate"><span class="pre">plot_cluster_trj_data()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.pairwise_distance">stacker.pairwise_distance module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj.__init__"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj.add_note"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj.args"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.MultiFrameTraj.with_traceback"><code class="docutils literal notranslate"><span class="pre">MultiFrameTraj.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.calculate_residue_distance"><code class="docutils literal notranslate"><span class="pre">calculate_residue_distance()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.get_residue_distance_for_frame"><code class="docutils literal notranslate"><span class="pre">get_residue_distance_for_frame()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.get_residue_distance_for_trajectory"><code class="docutils literal notranslate"><span class="pre">get_residue_distance_for_trajectory()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.system_stacking_fingerprints"><code class="docutils literal notranslate"><span class="pre">system_stacking_fingerprints()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.get_frame_average"><code class="docutils literal notranslate"><span class="pre">get_frame_average()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.get_top_stacking"><code class="docutils literal notranslate"><span class="pre">get_top_stacking()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.pairwise_distance.increment_residue"><code class="docutils literal notranslate"><span class="pre">increment_residue()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.residue_movement">stacker.residue_movement module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.collect_atom_locations_by_frame"><code class="docutils literal notranslate"><span class="pre">collect_atom_locations_by_frame()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.calc_center_3pts"><code class="docutils literal notranslate"><span class="pre">calc_center_3pts()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.Base"><code class="docutils literal notranslate"><span class="pre">Base</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.Base.__init__"><code class="docutils literal notranslate"><span class="pre">Base.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.create_base_from_coords_list"><code class="docutils literal notranslate"><span class="pre">create_base_from_coords_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.correct_theta_sign"><code class="docutils literal notranslate"><span class="pre">correct_theta_sign()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.calculate_bottaro_values_for_frame"><code class="docutils literal notranslate"><span class="pre">calculate_bottaro_values_for_frame()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.residue_movement.write_bottaro_to_csv"><code class="docutils literal notranslate"><span class="pre">write_bottaro_to_csv()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.vector">stacker.vector module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector"><code class="docutils literal notranslate"><span class="pre">Vector</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.__init__"><code class="docutils literal notranslate"><span class="pre">Vector.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.calculate_cross_product"><code class="docutils literal notranslate"><span class="pre">Vector.calculate_cross_product()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.magnitude"><code class="docutils literal notranslate"><span class="pre">Vector.magnitude()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.calculate_projection"><code class="docutils literal notranslate"><span class="pre">Vector.calculate_projection()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.vector.Vector.scale"><code class="docutils literal notranslate"><span class="pre">Vector.scale()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker.visualization">stacker.visualization module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues"><code class="docutils literal notranslate"><span class="pre">NoResidues</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues.__init__"><code class="docutils literal notranslate"><span class="pre">NoResidues.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues.add_note"><code class="docutils literal notranslate"><span class="pre">NoResidues.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues.args"><code class="docutils literal notranslate"><span class="pre">NoResidues.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.NoResidues.with_traceback"><code class="docutils literal notranslate"><span class="pre">NoResidues.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.create_parent_directories"><code class="docutils literal notranslate"><span class="pre">create_parent_directories()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.create_axis_labels"><code class="docutils literal notranslate"><span class="pre">create_axis_labels()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.display_arrays_as_video"><code class="docutils literal notranslate"><span class="pre">display_arrays_as_video()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.set_polar_grid"><code class="docutils literal notranslate"><span class="pre">set_polar_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.visualize_two_residue_movement_scatterplot"><code class="docutils literal notranslate"><span class="pre">visualize_two_residue_movement_scatterplot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.visualization.visualize_two_residue_movement_heatmap"><code class="docutils literal notranslate"><span class="pre">visualize_two_residue_movement_heatmap()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stacker">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine.__init__"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine.add_note"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine.args"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.InvalidRoutine.with_traceback"><code class="docutils literal notranslate"><span class="pre">InvalidRoutine.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty"><code class="docutils literal notranslate"><span class="pre">ResEmpty</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty.__init__"><code class="docutils literal notranslate"><span class="pre">ResEmpty.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty.add_note"><code class="docutils literal notranslate"><span class="pre">ResEmpty.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty.args"><code class="docutils literal notranslate"><span class="pre">ResEmpty.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.ResEmpty.with_traceback"><code class="docutils literal notranslate"><span class="pre">ResEmpty.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty"><code class="docutils literal notranslate"><span class="pre">AtomEmpty</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty.__init__"><code class="docutils literal notranslate"><span class="pre">AtomEmpty.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty.add_note"><code class="docutils literal notranslate"><span class="pre">AtomEmpty.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty.args"><code class="docutils literal notranslate"><span class="pre">AtomEmpty.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.AtomEmpty.with_traceback"><code class="docutils literal notranslate"><span class="pre">AtomEmpty.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty"><code class="docutils literal notranslate"><span class="pre">FrameEmpty</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty.__init__"><code class="docutils literal notranslate"><span class="pre">FrameEmpty.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty.add_note"><code class="docutils literal notranslate"><span class="pre">FrameEmpty.add_note()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty.args"><code class="docutils literal notranslate"><span class="pre">FrameEmpty.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.FrameEmpty.with_traceback"><code class="docutils literal notranslate"><span class="pre">FrameEmpty.with_traceback()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.block_printing"><code class="docutils literal notranslate"><span class="pre">block_printing()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.enable_printing"><code class="docutils literal notranslate"><span class="pre">enable_printing()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.run_python_command"><code class="docutils literal notranslate"><span class="pre">run_python_command()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.convert_to_python_command"><code class="docutils literal notranslate"><span class="pre">convert_to_python_command()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.filter_traj_routine"><code class="docutils literal notranslate"><span class="pre">filter_traj_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.bottaro_routine"><code class="docutils literal notranslate"><span class="pre">bottaro_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.res_distance_routine"><code class="docutils literal notranslate"><span class="pre">res_distance_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.system_routine"><code class="docutils literal notranslate"><span class="pre">system_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.combine_frames"><code class="docutils literal notranslate"><span class="pre">combine_frames()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.stack_events_routine"><code class="docutils literal notranslate"><span class="pre">stack_events_routine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacker.compare_routine"><code class="docutils literal notranslate"><span class="pre">compare_routine()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Eric D. Sakkas
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, Eric D. Sakkas.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>